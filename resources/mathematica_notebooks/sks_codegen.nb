(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    270002,       6549]
NotebookOptionsPosition[    249831,       6205]
NotebookOutlinePosition[    250505,       6227]
CellTagsIndexPosition[    250462,       6224]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["ADM components codegen", "Title",
 CellChangeTimes->{{3.857833982358945*^9, 3.8578339958689127`*^9}, {
  3.8612036019661617`*^9, 3.8612036040664597`*^9}, {3.868479896604311*^9, 
  3.8684799009040422`*^9}},ExpressionUUID->"8ff0d09f-00f0-43c0-a1d1-\
c2aaec281461"],

Cell[CellGroupData[{

Cell["4-metric", "Section",
 CellChangeTimes->{{3.860108273377863*^9, 3.860108287766755*^9}, {
   3.860109488774036*^9, 3.860109496113961*^9}, {3.861110516404187*^9, 
   3.86111052048457*^9}, 3.861117030968712*^9, {3.861124849351673*^9, 
   3.861124855991452*^9}, {3.868481639528853*^9, 
   3.868481639698598*^9}},ExpressionUUID->"1c41b9a9-7400-42a4-b2ac-\
9cebb1a7d2a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ll4metric", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ll4metric", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"llgSKS", "[", 
          RowBox[{"1", ",", "1", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"1", ",", "2", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"1", ",", "3", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"1", ",", "4", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"llgSKS", "[", 
          RowBox[{"1", ",", "2", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"2", ",", "2", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"2", ",", "3", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"2", ",", "4", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"llgSKS", "[", 
          RowBox[{"1", ",", "3", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"2", ",", "3", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"3", ",", "3", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"3", ",", "4", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"llgSKS", "[", 
          RowBox[{"1", ",", "4", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"2", ",", "4", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"3", ",", "4", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}], ",", 
         RowBox[{"llgSKS", "[", 
          RowBox[{"4", ",", "4", ",", "t", ",", "x", ",", "y", ",", "z"}], 
          "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "uu4metric", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uu4metric", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Inverse", "[", "ll4metric", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.861214198023122*^9, 3.861214218191215*^9}, {
   3.861214406844845*^9, 3.8612144807930603`*^9}, {3.861232332362925*^9, 
   3.8612323986409683`*^9}, {3.8612324591427107`*^9, 3.861232665651525*^9}, {
   3.8612326961995773`*^9, 3.8612329333174343`*^9}, {3.861233000167461*^9, 
   3.8612330033468018`*^9}, {3.86123304404681*^9, 3.8612330578966303`*^9}, {
   3.861233095374798*^9, 3.86123311561348*^9}, {3.861233149250637*^9, 
   3.861233181387703*^9}, {3.861233422893813*^9, 3.861233432232362*^9}, {
   3.861235150000181*^9, 3.8612352476772127`*^9}, 3.8612353119107523`*^9, {
   3.861235367758133*^9, 3.8612353682263803`*^9}, {3.861910628170557*^9, 
   3.861910678698352*^9}, {3.861910730255834*^9, 3.861910776842757*^9}, {
   3.861910818480976*^9, 3.861910825370202*^9}, {3.8619108611298532`*^9, 
   3.861910866348127*^9}, {3.861910925147826*^9, 3.861910939997694*^9}, {
   3.861910991335287*^9, 3.861910993784485*^9}, {3.862414525739798*^9, 
   3.86241457709769*^9}, {3.862414631666744*^9, 3.862414696905101*^9}, {
   3.862414727030507*^9, 3.8624148671834927`*^9}, {3.865013026873619*^9, 
   3.86501302761779*^9}, {3.865013105702722*^9, 3.8650131086687326`*^9}, {
   3.86535198019002*^9, 3.8653519873189898`*^9}, {3.86535279032789*^9, 
   3.865352812344174*^9}, {3.865359120067219*^9, 3.8653591206841373`*^9}, {
   3.865433323227047*^9, 3.865433451905299*^9}, {3.865433488195641*^9, 
   3.865433530425619*^9}, {3.865433590782172*^9, 3.865433592458993*^9}, {
   3.865469135034416*^9, 3.8654691458327513`*^9}, {3.86564600583885*^9, 
   3.865646026177759*^9}, {3.865646578516676*^9, 3.865646579846388*^9}, {
   3.8656467932124643`*^9, 3.865646884851976*^9}, {3.865647100207974*^9, 
   3.865647108186438*^9}, {3.865647303422084*^9, 3.865647325542205*^9}, 
   3.8656473588824*^9, {3.8656475770354967`*^9, 3.8656477745971527`*^9}, {
   3.865647807555604*^9, 3.865647903768586*^9}, {3.865647961561305*^9, 
   3.865647969031136*^9}, {3.866816911109275*^9, 3.866816915329042*^9}, {
   3.866817136584443*^9, 3.866817139814*^9}, {3.866818698520643*^9, 
   3.8668187912827597`*^9}, {3.8668188243595133`*^9, 3.866818869340055*^9}, {
   3.866818973821392*^9, 3.8668189868977547`*^9}, {3.866819060178199*^9, 
   3.866819064947411*^9}, {3.866819209544312*^9, 3.866819236844933*^9}, {
   3.866819286677269*^9, 3.866819297075508*^9}, {3.866819343815485*^9, 
   3.866819387511808*^9}, {3.866819579607584*^9, 3.8668195870872307`*^9}, {
   3.866819650556964*^9, 3.8668196548765*^9}, {3.8668200634189577`*^9, 
   3.866820092426619*^9}, {3.866824327310947*^9, 3.866824330760445*^9}, {
   3.866827120187018*^9, 3.866827121826496*^9}, {3.866846225075459*^9, 
   3.866846231784719*^9}, {3.866846346852791*^9, 3.8668463515221157`*^9}, {
   3.8681017732123938`*^9, 3.868101774991975*^9}, {3.868101916619342*^9, 
   3.868101929619321*^9}, {3.868102071206533*^9, 3.86810212839532*^9}, {
   3.868102220547242*^9, 3.868102239163382*^9}, {3.8681022703236837`*^9, 
   3.868102339292926*^9}, {3.868102472119788*^9, 3.868102492938582*^9}, {
   3.8681027970452843`*^9, 3.868102805074115*^9}, {3.868104310383934*^9, 
   3.868104342822318*^9}, {3.868104407784952*^9, 3.868104412391169*^9}, {
   3.868104629044733*^9, 3.868104687917234*^9}, {3.86810498286202*^9, 
   3.8681050527251873`*^9}, {3.86831459830226*^9, 3.86831469768677*^9}, {
   3.868314729617243*^9, 3.868314734626923*^9}, {3.868314845935163*^9, 
   3.868314849864133*^9}, {3.868315002812252*^9, 3.8683150303119164`*^9}, {
   3.868315079068935*^9, 3.868315122918209*^9}, {3.868315620691969*^9, 
   3.8683156321938457`*^9}, 3.8683157627932158`*^9, {3.868384303204479*^9, 
   3.868384306007306*^9}, {3.868395453825572*^9, 3.868395459754818*^9}, {
   3.868395806378737*^9, 3.868395832288477*^9}, {3.8683958979670153`*^9, 
   3.868395965864122*^9}, {3.8683961050839376`*^9, 3.868396170810891*^9}, {
   3.868396319200158*^9, 3.868396402756311*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a31afc9d-f6d1-4e3e-a952-28d3bc48d72f"]
}, Closed]],

Cell[CellGroupData[{

Cell["ADM components", "Section",
 CellChangeTimes->{{3.868315565800763*^9, 
  3.868315568650415*^9}},ExpressionUUID->"0f6f3127-1aac-4633-bd66-\
94cd73509965"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "coords", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coords", "=", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Spatial", " ", "coordinates"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "spaceCoords", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"spaceCoords", "=", 
    RowBox[{"coords", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", "4"}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"llsmetric", ",", "uusmetric"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"llsmetric", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ll4metric", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"2", ";;", "4"}], ",", 
       RowBox[{"2", ";;", "4"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uusmetric", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Inverse", "[", "llsmetric", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "lapse", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lapse", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"uu4metric", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"lshift", ",", "ushift"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"lshift", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ll4metric", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"2", ";;", "4"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ushift", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"lapse", "^", "2"}], "*", 
      RowBox[{"uu4metric", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"2", ";;", "4"}]}], "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"\[CapitalGamma]", ",", "Dd"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]", "=", 
    RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], "*", 
          RowBox[{"uusmetric", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "l"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"llsmetric", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"spaceCoords", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"llsmetric", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"spaceCoords", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"llsmetric", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"spaceCoords", "[", 
               RowBox[{"[", "l", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Dd", "[", 
     RowBox[{"b_", ",", "c_", ",", "f_"}], "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "c", "]"}], "]"}], ",", 
        RowBox[{"spaceCoords", "[", 
         RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"[", 
           RowBox[{"d", ",", "b", ",", "c"}], "]"}], "]"}], " ", 
         RowBox[{"f", "[", 
          RowBox[{"[", "d", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"llextrinsic", ",", "ulextrinsic"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"llextrinsic", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"2", "*", "lapse"}], ")"}]}], "*", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"llsmetric", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"coords", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
        RowBox[{"Dd", "[", 
         RowBox[{"i", ",", "j", ",", "lshift"}], "]"}], "+", 
        RowBox[{"Dd", "[", 
         RowBox[{"j", ",", "i", ",", "lshift"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ulextrinsic", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"uusmetric", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
         RowBox[{"llextrinsic", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8683155796117268`*^9, 3.8683156169909887`*^9}, {
  3.868315695719469*^9, 3.868315744238131*^9}, {3.868396445906399*^9, 
  3.868396479823942*^9}, {3.870279681836549*^9, 3.870279685794715*^9}, {
  3.870279803245348*^9, 3.8702798377322903`*^9}, {3.870279870362689*^9, 
  3.870279888070991*^9}, {3.872121079289297*^9, 3.872121088511879*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ecc62a60-379d-472e-ab04-cfac23a0d0a0"]
}, Closed]],

Cell[CellGroupData[{

Cell["CSE and codegen utilities", "Section",
 CellChangeTimes->{{3.868439204911605*^9, 
  3.868439214061768*^9}},ExpressionUUID->"553a9113-a371-48fc-bc00-\
d2595122b733"],

Cell[CellGroupData[{

Cell["CSE", "Subsection",
 CellChangeTimes->{{3.868371468625771*^9, 
  3.868371468976837*^9}},ExpressionUUID->"d1434d19-8af1-4e2c-a878-\
97c7290b23e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], "/", 
       "4202845"}], "/", "mathematica"}], "-", "using", "-", "simplify", "-", 
     "to", "-", "do", "-", "common", "-", "sub", "-", "expression", "-", 
     "elimination", "-", "and", "-", "reductio"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"stoney", ".", "sb", ".", "org"}], "/", "wordpress"}], "/", 
      "wp"}], "-", 
     RowBox[{
      RowBox[{"content", "/", "cvt2c"}], "/"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"<<", "cse.m"}]}]], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"99eec412-90a9-4795-ba53-ce4fd1537707"]
}, Closed]],

Cell[CellGroupData[{

Cell["Capitalization", "Subsection",
 CellChangeTimes->{{3.868439493907201*^9, 
  3.868439496307272*^9}},ExpressionUUID->"13cf0238-6bd6-4961-b5a9-\
4f6156906d24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "capitalizationRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"capitalizationRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868316105323255*^9, 3.868316157929685*^9}, {
   3.868316230109397*^9, 3.868316306948285*^9}, {3.86831634177719*^9, 
   3.86831635056705*^9}, {3.868316425275738*^9, 3.868316537946056*^9}, {
   3.868316591092558*^9, 3.868316597142627*^9}, {3.8683166621718187`*^9, 
   3.8683166908708763`*^9}, {3.868371896499003*^9, 3.8683719011111813`*^9}, {
   3.868375787792369*^9, 3.86837583159341*^9}, {3.868381925961285*^9, 
   3.868381934913391*^9}, {3.8683968959356737`*^9, 3.8683970125234003`*^9}, {
   3.8684004316580677`*^9, 3.868400458276379*^9}, {3.868400961138571*^9, 
   3.868400962018216*^9}, {3.8684011791176558`*^9, 3.868401187714568*^9}, {
   3.868401291792986*^9, 3.868401466970656*^9}, {3.868401504491877*^9, 
   3.8684015112202682`*^9}, 3.868439343095846*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"7a83c6f5-cabd-4ab3-b66d-aa2d112aefa5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric", "Subsection",
 CellChangeTimes->{{3.86844037896544*^9, 
  3.868440379805462*^9}},ExpressionUUID->"42e0f279-8c41-474b-a19d-\
b671962febe5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "metricComponentRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metricComponentRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<llgSKS(1,1,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_00(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(1,2,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_01(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(1,3,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_02(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(1,4,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_03(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(2,2,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_11(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(2,3,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_12(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(2,4,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_13(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(3,3,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_22(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(3,4,t,x,y,z)\>\"", "\[Rule]", "\"\<llgSKS_23(t,x,y,z)\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<llgSKS(4,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<llgSKS_33(t,x,y,z)\>\""}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.868480207676696*^9, 3.86848022482598*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"bc1af3bc-7087-4e98-b015-b9ba92b5c999"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric derivatives", "Subsection",
 CellChangeTimes->{{3.8684638116042957`*^9, 
  3.868463816164253*^9}},ExpressionUUID->"f89d3173-2b3d-408b-bec8-\
8641803da54d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "metricComponentDerivativeRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metricComponentDerivativeRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(1,1,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_00_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(1,1,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_00_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(1,1,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_00_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(1,1,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_00_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(1,2,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_01_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(1,2,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_01_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(1,2,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_01_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(1,2,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_01_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(1,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_02_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(1,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_02_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(1,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_02_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(1,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_02_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(1,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_03_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(1,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_03_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(1,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_03_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(1,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_03_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(2,2,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_11_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(2,2,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_11_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(2,2,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_11_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(2,2,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_11_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(2,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_12_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(2,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_12_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(2,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_12_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(2,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_12_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(2,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_13_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(2,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_13_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(2,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_13_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(2,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_13_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(3,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_22_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(3,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_22_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(3,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_22_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(3,3,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_22_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(3,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_23_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(3,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_23_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(3,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_23_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(3,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_23_dz(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0,0,0)(llgSKS)(4,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_33_dt(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0,0)(llgSKS)(4,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_33_dx(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1,0)(llgSKS)(4,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_33_dy(t,x,y,z)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,0,1)(llgSKS)(4,4,t,x,y,z)\>\"", "\[Rule]", 
      "\"\<dllgSKS_33_dz(t,x,y,z)\>\""}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.868463848105813*^9, 3.868464021663855*^9}, {
  3.8684640889125338`*^9, 3.868464148150791*^9}, {3.8684652071875687`*^9, 
  3.868465255785811*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"e3b8a2a7-3fc4-43a7-a060-f11fd546fe38"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Lapse code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 
  3.868439195311709*^9}},ExpressionUUID->"1c5ffc1e-6978-46ab-8811-\
a70ae4ffe0a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::lapse(double t, double x, double y, double \
z) -> double {\n  using std::pow;\n  using std::sqrt;\n\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "lapse", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  return \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"expr", ",", "CForm"}], "]"}], "<>", "\"\<;\\n}\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<lapse.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i lapse.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv lapse.cpp ../../plugins/metrics/SKS/source\>\"", "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr", ",", "str"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.8684800926406384`*^9, 3.8684800935299807`*^9}, {
   3.868480469591303*^9, 3.868480531491208*^9}, {3.8702806069263144`*^9, 
   3.8702806429159327`*^9}, {3.870280699644123*^9, 3.870280713303274*^9}, {
   3.870281087786936*^9, 3.870281202754883*^9}, {3.87028123429452*^9, 
   3.870281611729458*^9}, {3.870281678336376*^9, 3.8702817272043667`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"32e1038d-9013-4759-948a-18da960b23be"]
}, Closed]],

Cell[CellGroupData[{

Cell["Lower shift code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 
  3.8684434947444773`*^9}},ExpressionUUID->"1971a534-376a-4e97-9998-\
a86e203b91cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::l_shift(double t, double x, double y, \
double z) -> metric_server::spatial_vector {\n\n  \
metric_server::spatial_vector lshift{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "lshift", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  lshift[0] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  lshift[1] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  lshift[2] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n  return lshift;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<l_shift.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i l_shift.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv l_shift.cpp ../../plugins/metrics/SKS/source\>\"", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr", ",", "str"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.868480584340295*^9, 3.868480589649892*^9}, 3.870288598733532*^9, {
   3.870288773907827*^9, 3.870288796094055*^9}, {3.8702888275153847`*^9, 
   3.8702889564706297`*^9}, {3.870289298165719*^9, 3.870289303765176*^9}, {
   3.8702894082578707`*^9, 3.870289435254959*^9}, {3.870545889238183*^9, 
   3.870545890036811*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"5611056a-14e3-4ecd-8366-c7e4f84f7f64"]
}, Closed]],

Cell[CellGroupData[{

Cell["Upper shift code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 3.8684434947444773`*^9}, {3.86845939026473*^9, 
  3.86845939164471*^9}},ExpressionUUID->"86329816-ea40-40fb-9378-\
0274b9195b2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::u_shift(double t, double x, double y, \
double z)\n    -> metric_server::spatial_vector {\n\n  using std::pow;\n\n  \
metric_server::spatial_vector ushift{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "ushift", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  ushift[0] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  ushift[1] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  ushift[2] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n  return ushift;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<u_shift.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i u_shift.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv u_shift.cpp ../../plugins/metrics/SKS/source\>\"", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr", ",", "str"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.868459441893629*^9, 3.8684594596743507`*^9}, {3.8684595043546677`*^9, 
   3.868459573673687*^9}, {3.868459605954773*^9, 3.8684596804925537`*^9}, {
   3.86845971442517*^9, 3.8684597188424664`*^9}, {3.868459772493168*^9, 
   3.868459867475919*^9}, {3.868459932461158*^9, 3.868460025622456*^9}, {
   3.868460104580467*^9, 3.8684601307208433`*^9}, {3.8684601619907227`*^9, 
   3.8684601848505783`*^9}, {3.868460338699321*^9, 3.86846034883677*^9}, {
   3.868460473748473*^9, 3.868460474699133*^9}, {3.8684806110012407`*^9, 
   3.868480625328967*^9}, {3.870289376351081*^9, 3.870289384665769*^9}, {
   3.870289424345621*^9, 3.870289426981441*^9}, {3.870289506933238*^9, 
   3.870289507758601*^9}, {3.870545903717436*^9, 3.870545904426785*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"ce199056-16d0-4883-9a59-1a10e00b9365"]
}, Closed]],

Cell[CellGroupData[{

Cell["Lower spatial metric code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 3.8684434947444773`*^9}, {3.86845939026473*^9, 
  3.86845939164471*^9}, {3.868460800761063*^9, 
  3.868460825459573*^9}},ExpressionUUID->"09ac9d3a-91ad-4125-a27c-\
3a7330fd7ac5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::ll_smetric(double t, double x, double y, \
double z)\n    -> metric_server::spatial_matrix {\n\n  \
metric_server::spatial_matrix llgamma{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "llsmetric", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  llgamma[\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<][\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<] = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"expr", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "CForm"}],
          "]"}], "<>", "\"\<;\>\""}]}], ";"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n\\n  return llgamma;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<ll_smetric.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i ll_smetric.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv ll_smetric.cpp ../../plugins/metrics/SKS/source\>\"", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"str", ",", "expr", ",", "cse"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.868459441893629*^9, 3.8684594596743507`*^9}, {3.8684595043546677`*^9, 
   3.868459573673687*^9}, {3.868459605954773*^9, 3.8684596804925537`*^9}, {
   3.86845971442517*^9, 3.8684597188424664`*^9}, {3.868459772493168*^9, 
   3.868459867475919*^9}, {3.868459932461158*^9, 3.868460025622456*^9}, {
   3.868460104580467*^9, 3.8684601307208433`*^9}, {3.8684601619907227`*^9, 
   3.8684601848505783`*^9}, {3.868460338699321*^9, 3.86846034883677*^9}, {
   3.868460473748473*^9, 3.868460474699133*^9}, {3.868461017811212*^9, 
   3.8684610834851503`*^9}, {3.86846111664362*^9, 3.868461191187995*^9}, {
   3.868461251758017*^9, 3.868461365883768*^9}, {3.868461409492908*^9, 
   3.868461416645146*^9}, {3.868461615093453*^9, 3.868461631338126*^9}, {
   3.868480683608389*^9, 3.868480705158721*^9}, {3.870289581486546*^9, 
   3.870289596331813*^9}, {3.870289666087577*^9, 3.870289712966387*^9}, {
   3.870289745006092*^9, 3.870289801843617*^9}, {3.870289837675084*^9, 
   3.8702899127227182`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"a3aef63f-401d-4d25-bd95-0f92fa7027c5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Upper spatial metric code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 3.8684434947444773`*^9}, {3.86845939026473*^9, 
  3.86845939164471*^9}, {3.868460800761063*^9, 3.868460825459573*^9}, {
  3.868461654866417*^9, 
  3.868461655526359*^9}},ExpressionUUID->"8d0d1af7-fcc4-4783-b65c-\
ab8f7ffa3ba2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::uu_smetric(double t, double x, double y, \
double z)\n    -> metric_server::spatial_matrix {\n\n  using std::pow;\n\n  \
metric_server::spatial_matrix uugamma{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "uusmetric", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  uugamma[\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<][\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<] = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"expr", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "CForm"}],
          "]"}], "<>", "\"\<;\>\""}]}], ";"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n\\n  return uugamma;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<uu_smetric.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i uu_smetric.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv uu_smetric.cpp ../../plugins/metrics/SKS/source\>\"", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"str", ",", "expr", ",", "cse"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.868459441893629*^9, 3.8684594596743507`*^9}, {3.8684595043546677`*^9, 
   3.868459573673687*^9}, {3.868459605954773*^9, 3.8684596804925537`*^9}, {
   3.86845971442517*^9, 3.8684597188424664`*^9}, {3.868459772493168*^9, 
   3.868459867475919*^9}, {3.868459932461158*^9, 3.868460025622456*^9}, {
   3.868460104580467*^9, 3.8684601307208433`*^9}, {3.8684601619907227`*^9, 
   3.8684601848505783`*^9}, {3.868460338699321*^9, 3.86846034883677*^9}, {
   3.868460473748473*^9, 3.868460474699133*^9}, {3.868461017811212*^9, 
   3.8684610834851503`*^9}, {3.86846111664362*^9, 3.868461191187995*^9}, {
   3.868461251758017*^9, 3.868461365883768*^9}, {3.868461409492908*^9, 
   3.868461416645146*^9}, {3.868461615093453*^9, 3.8684617164886837`*^9}, {
   3.868480790806924*^9, 3.868480803536764*^9}, {3.868481573351701*^9, 
   3.868481576740884*^9}, {3.8702899518911123`*^9, 3.870289983604669*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"f9f02549-a8c6-4c72-8df4-62ffd924632d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Lower extrinsic code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 3.8684434947444773`*^9}, {3.86845939026473*^9, 
  3.86845939164471*^9}, {3.868460800761063*^9, 3.868460825459573*^9}, {
  3.868461654866417*^9, 3.868461655526359*^9}, {3.868463665417062*^9, 
  3.86846367186619*^9}},ExpressionUUID->"faaa3967-8064-48f1-a612-\
f6e18f0ab5fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::ll_extrinsic(double t, double x, double y, \
double z)\n    -> metric_server::spatial_matrix {\n\n  using std::pow;\n\n  \
metric_server::spatial_matrix llK{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "llextrinsic", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  llK[\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<][\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<] = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"expr", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "CForm"}],
          "]"}], "<>", "\"\<;\>\""}]}], ";"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n\\n  return llK;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "metricComponentDerivativeRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<ll_extrinsic.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i ll_extrinsic.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv ll_extrinsic.cpp ../../plugins/metrics/SKS/source\>\"",
     "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"str", ",", "expr", ",", "cse"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.868459441893629*^9, 3.8684594596743507`*^9}, {3.8684595043546677`*^9, 
   3.868459573673687*^9}, {3.868459605954773*^9, 3.8684596804925537`*^9}, {
   3.86845971442517*^9, 3.8684597188424664`*^9}, {3.868459772493168*^9, 
   3.868459867475919*^9}, {3.868459932461158*^9, 3.868460025622456*^9}, {
   3.868460104580467*^9, 3.8684601307208433`*^9}, {3.8684601619907227`*^9, 
   3.8684601848505783`*^9}, {3.868460338699321*^9, 3.86846034883677*^9}, {
   3.868460473748473*^9, 3.868460474699133*^9}, {3.868461017811212*^9, 
   3.8684610834851503`*^9}, {3.86846111664362*^9, 3.868461191187995*^9}, {
   3.868461251758017*^9, 3.868461365883768*^9}, {3.868461409492908*^9, 
   3.868461416645146*^9}, {3.868461615093453*^9, 3.8684617164886837`*^9}, {
   3.868463707304528*^9, 3.868463744845603*^9}, {3.868464163839583*^9, 
   3.868464169209422*^9}, {3.868464278388085*^9, 3.868464280109803*^9}, {
   3.868465099397458*^9, 3.8684651564754*^9}, {3.868465188887418*^9, 
   3.86846519063492*^9}, {3.8684808523558064`*^9, 3.868480864585908*^9}, {
   3.868481423965321*^9, 3.8684814490840282`*^9}, {3.870290048585804*^9, 
   3.870290079262692*^9}, {3.870290136209305*^9, 3.870290140418495*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"6aaa50c1-4142-4010-b15b-b83f690f7630"]
}, Closed]],

Cell[CellGroupData[{

Cell["Upper lower extrinsic code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 3.8684434947444773`*^9}, {3.86845939026473*^9, 
  3.86845939164471*^9}, {3.868460800761063*^9, 3.868460825459573*^9}, {
  3.868461654866417*^9, 3.868461655526359*^9}, {3.868463665417062*^9, 
  3.86846367186619*^9}, {3.868465292952746*^9, 
  3.8684652950428247`*^9}},ExpressionUUID->"0d9d7614-7377-4a42-9694-\
ad0c2f2c8dca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::ul_extrinsic(double t, double x, double y, \
double z)\n    -> metric_server::spatial_matrix {\n\n  using std::pow;\n\n  \
metric_server::spatial_matrix ulK{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "ulextrinsic", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  ulK[\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<][\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<] = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"expr", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "CForm"}],
          "]"}], "<>", "\"\<;\>\""}]}], ";"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n\\n  return ulK;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "metricComponentDerivativeRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<ul_extrinsic.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i ul_extrinsic.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv ul_extrinsic.cpp ../../plugins/metrics/SKS/source\>\"",
     "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "str", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "expr", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.868459441893629*^9, 3.8684594596743507`*^9}, {3.8684595043546677`*^9, 
   3.868459573673687*^9}, {3.868459605954773*^9, 3.8684596804925537`*^9}, {
   3.86845971442517*^9, 3.8684597188424664`*^9}, {3.868459772493168*^9, 
   3.868459867475919*^9}, {3.868459932461158*^9, 3.868460025622456*^9}, {
   3.868460104580467*^9, 3.8684601307208433`*^9}, {3.8684601619907227`*^9, 
   3.8684601848505783`*^9}, {3.868460338699321*^9, 3.86846034883677*^9}, {
   3.868460473748473*^9, 3.868460474699133*^9}, {3.868461017811212*^9, 
   3.8684610834851503`*^9}, {3.86846111664362*^9, 3.868461191187995*^9}, {
   3.868461251758017*^9, 3.868461365883768*^9}, {3.868461409492908*^9, 
   3.868461416645146*^9}, {3.868461615093453*^9, 3.8684617164886837`*^9}, {
   3.868463707304528*^9, 3.868463744845603*^9}, {3.868464163839583*^9, 
   3.868464169209422*^9}, {3.868464278388085*^9, 3.868464280109803*^9}, {
   3.868465099397458*^9, 3.8684651564754*^9}, {3.868465188887418*^9, 
   3.86846519063492*^9}, {3.868465311858987*^9, 3.868465351621957*^9}, {
   3.868466060859128*^9, 3.8684660962470493`*^9}, {3.8684809646247597`*^9, 
   3.868480974753751*^9}, {3.868481536182946*^9, 3.868481540962041*^9}, {
   3.870290164825817*^9, 3.87029017760143*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"7cea7cda-d6bd-4f2d-8d1b-f3b150b89850"]
}, Closed]],

Cell[CellGroupData[{

Cell["Spatial christoffel code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 3.8684434947444773`*^9}, {3.86845939026473*^9, 
  3.86845939164471*^9}, {3.868460800761063*^9, 3.868460825459573*^9}, {
  3.868461654866417*^9, 3.868461655526359*^9}, {3.868463665417062*^9, 
  3.86846367186619*^9}, {3.868465292952746*^9, 3.8684652950428247`*^9}, {
  3.868477391504071*^9, 3.868477397434286*^9}, {3.868477618842594*^9, 
  3.868477621672473*^9}},ExpressionUUID->"3b8081d0-b79b-46ff-8515-\
8fa9082a1ccc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::spatial_christoffel(double t, double x, \
double y, double z)\n    -> metric_server::chirstofell_t {\n\n  using \
std::pow;\n\n  metric_server::chirstofell_t Gamma{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "\[CapitalGamma]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  Gamma[\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<][\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<][\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"k", "-", "1"}], "]"}], "<>", "\"\<] = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"expr", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], ";"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n\\n  return Gamma;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "metricComponentDerivativeRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<spatial_christoffel.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Run", "[", "\"\<clang-format -i spatial_christoffel.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", 
    "\"\<mv spatial_christoffel.cpp ../../plugins/metrics/SKS/source\>\"", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"str", ",", "expr", ",", "cse"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.868459441893629*^9, 3.8684594596743507`*^9}, {3.8684595043546677`*^9, 
   3.868459573673687*^9}, {3.868459605954773*^9, 3.8684596804925537`*^9}, {
   3.86845971442517*^9, 3.8684597188424664`*^9}, {3.868459772493168*^9, 
   3.868459867475919*^9}, {3.868459932461158*^9, 3.868460025622456*^9}, {
   3.868460104580467*^9, 3.8684601307208433`*^9}, {3.8684601619907227`*^9, 
   3.8684601848505783`*^9}, {3.868460338699321*^9, 3.86846034883677*^9}, {
   3.868460473748473*^9, 3.868460474699133*^9}, {3.868461017811212*^9, 
   3.8684610834851503`*^9}, {3.86846111664362*^9, 3.868461191187995*^9}, {
   3.868461251758017*^9, 3.868461365883768*^9}, {3.868461409492908*^9, 
   3.868461416645146*^9}, {3.868461615093453*^9, 3.8684617164886837`*^9}, {
   3.868463707304528*^9, 3.868463744845603*^9}, {3.868464163839583*^9, 
   3.868464169209422*^9}, {3.868464278388085*^9, 3.868464280109803*^9}, {
   3.868465099397458*^9, 3.8684651564754*^9}, {3.868465188887418*^9, 
   3.86846519063492*^9}, {3.868465311858987*^9, 3.868465351621957*^9}, {
   3.868466060859128*^9, 3.8684660962470493`*^9}, {3.868477433745366*^9, 
   3.868477500114278*^9}, {3.868477807604356*^9, 3.8684778142088633`*^9}, 
   3.8684779281995583`*^9, 3.868477976457665*^9, {3.8684782837768497`*^9, 
   3.86847834944176*^9}, {3.868478402825157*^9, 3.868478407373564*^9}, {
   3.868478472935071*^9, 3.868478495111987*^9}, {3.868479008976038*^9, 
   3.868479049588788*^9}, {3.868481023373115*^9, 3.8684810367653723`*^9}, {
   3.868481075232855*^9, 3.868481075752067*^9}, {3.8684814925941753`*^9, 
   3.868481495963325*^9}, {3.8702902394707127`*^9, 3.870290264013768*^9}, {
   3.870290637808576*^9, 3.8702906415181*^9}, {3.8702916395134697`*^9, 
   3.870291699567417*^9}, {3.8702917564153137`*^9, 3.870291756695509*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"49201f12-b80d-4e32-ab1c-215e1ed1d799"]
}, Closed]],

Cell[CellGroupData[{

Cell["Grad lapse code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 3.8684434947444773`*^9}, {3.868479227632594*^9, 
  3.868479229812614*^9}},ExpressionUUID->"2bc60a79-e700-4b58-8d0e-\
8bbfa5a58481"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::grad_lapse(double t, double x, double y, \
double z)\n    -> metric_server::spatial_vector {\n\n  using std::pow;\n\n  \
metric_server::spatial_vector gradalpha{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"lapse", ",", "x"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{"lapse", ",", "y"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{"lapse", ",", "z"}], "]"}]}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradalpha[0] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradalpha[1] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n  gradalpha[2] = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"expr", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
        ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n\\n  return gradalpha;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "metricComponentDerivativeRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<grad_lapse.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i grad_lapse.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv grad_lapse.cpp ../../plugins/metrics/SKS/source\>\"", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"str", ",", "expr", ",", "cse"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.86847924650378*^9, 3.868479304621502*^9}, {3.868479356091648*^9, 
   3.868479383663774*^9}, {3.868481115870646*^9, 3.86848113336057*^9}, {
   3.868481298158586*^9, 3.868481302506521*^9}, 3.870290524617415*^9, {
   3.870290555441577*^9, 3.870290676817841*^9}, {3.8702907591969137`*^9, 
   3.870290767725171*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"e023fe7d-f334-4fe5-8d1e-e98268ec1837"]
}, Closed]],

Cell[CellGroupData[{

Cell["Grad ushift code", "Section",
 CellChangeTimes->{{3.86843919338174*^9, 3.868439195311709*^9}, {
  3.868443483034787*^9, 3.8684434947444773`*^9}, {3.86845939026473*^9, 
  3.86845939164471*^9}, {3.868460800761063*^9, 3.868460825459573*^9}, {
  3.868461654866417*^9, 3.868461655526359*^9}, {3.868463665417062*^9, 
  3.86846367186619*^9}, {3.868465292952746*^9, 3.8684652950428247`*^9}, {
  3.8684795445141897`*^9, 
  3.868479547204159*^9}},ExpressionUUID->"a028fb09-f0fe-44b9-993e-\
777659d83339"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "str", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "str", "=", 
    "\"\<#include \\\"SKS.hpp\\\"\n\nusing namespace grlensing;\n\n\
GRLENSING_SKS_METRIC_API auto SKS::grad_ushift(double t, double x, double y, \
double z)\n    -> metric_server::spatial_matrix {\n\n  using std::pow;\n\n  \
metric_server::spatial_matrix gradushift{};\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"cse", ",", "expr"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cse", "=", 
   RowBox[{"hoistCommonSubexpressions", "[", "\[IndentingNewLine]", 
    RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", "x"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "x"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         ",", "x"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", "y"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "y"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         ",", "y"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
         "ushift", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         ",", "z"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ClearAll", "[", "var", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"cse", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
          "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradushift[0][0] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradushift[0][1] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradushift[0][2] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradushift[1][0] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradushift[1][1] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradushift[1][2] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradushift[2][0] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<\\n  gradushift[2][1] = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"expr", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], 
      ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n  gradushift[2][2] = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"expr", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}],
        ",", "CForm"}], "]"}], "<>", "\"\<;\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"str", "<>", "\"\<\\n\\n  return gradushift;\\n}\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"str", ",", "metricComponentDerivativeRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "metricComponentRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<grad_ushift.cpp\>\"", ",", "str", ",", "\"\<Text\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i grad_ushift.cpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", "\"\<mv grad_ushift.cpp ../../plugins/metrics/SKS/source\>\"", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"str", ",", "expr", ",", "cse"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868439531872287*^9, 3.868439540226551*^9}, {
   3.868440397954917*^9, 3.868440407694569*^9}, {3.868441452647648*^9, 
   3.868441504288352*^9}, 3.86844153517411*^9, {3.8684424834949512`*^9, 
   3.868442530353948*^9}, {3.8684426354131527`*^9, 3.868442684224793*^9}, {
   3.868443188102881*^9, 3.868443256730607*^9}, {3.8684433232790728`*^9, 
   3.86844336587852*^9}, {3.868443530099223*^9, 3.868443564642498*^9}, {
   3.8684577583000097`*^9, 3.86845782001092*^9}, {3.86845901985045*^9, 
   3.86845928073599*^9}, {3.8684593179766283`*^9, 3.868459326766025*^9}, {
   3.868459441893629*^9, 3.8684594596743507`*^9}, {3.8684595043546677`*^9, 
   3.868459573673687*^9}, {3.868459605954773*^9, 3.8684596804925537`*^9}, {
   3.86845971442517*^9, 3.8684597188424664`*^9}, {3.868459772493168*^9, 
   3.868459867475919*^9}, {3.868459932461158*^9, 3.868460025622456*^9}, {
   3.868460104580467*^9, 3.8684601307208433`*^9}, {3.8684601619907227`*^9, 
   3.8684601848505783`*^9}, {3.868460338699321*^9, 3.86846034883677*^9}, {
   3.868460473748473*^9, 3.868460474699133*^9}, {3.868461017811212*^9, 
   3.8684610834851503`*^9}, {3.86846111664362*^9, 3.868461191187995*^9}, {
   3.868461251758017*^9, 3.868461365883768*^9}, {3.868461409492908*^9, 
   3.868461416645146*^9}, {3.868461615093453*^9, 3.8684617164886837`*^9}, {
   3.868463707304528*^9, 3.868463744845603*^9}, {3.868464163839583*^9, 
   3.868464169209422*^9}, {3.868464278388085*^9, 3.868464280109803*^9}, {
   3.868465099397458*^9, 3.8684651564754*^9}, {3.868465188887418*^9, 
   3.86846519063492*^9}, {3.868465311858987*^9, 3.868465351621957*^9}, {
   3.868466060859128*^9, 3.8684660962470493`*^9}, {3.8684795660205917`*^9, 
   3.868479608184321*^9}, {3.868479698211265*^9, 3.868479772208667*^9}, {
   3.868479807518861*^9, 3.8684798101481028`*^9}, {3.868481165530004*^9, 
   3.8684811728496237`*^9}, {3.8684813195794773`*^9, 3.868481322956952*^9}, {
   3.870291246552916*^9, 3.870291341892715*^9}, {3.870291426663295*^9, 
   3.870291453302005*^9}, {3.870291493472363*^9, 3.870291494481942*^9}, {
   3.870291526355205*^9, 3.870291534443293*^9}, {3.872120893424301*^9, 
   3.8721210251696568`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"0ab0b32a-e1d2-48f5-9334-6369003d64fe"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric components codegen", "Title",
 CellChangeTimes->{{3.86847991167406*^9, 
  3.8684799156038027`*^9}},ExpressionUUID->"11f83cd4-d82e-4d87-b5fd-\
c34399b0df27"],

Cell[CellGroupData[{

Cell["CSE and codegen utilities", "Section",
 CellChangeTimes->{{3.868439204911605*^9, 
  3.868439214061768*^9}},ExpressionUUID->"9dabb1ed-2e99-443f-932c-\
2a303feb5221"],

Cell[CellGroupData[{

Cell["CSE", "Subsection",
 CellChangeTimes->{{3.868371468625771*^9, 
  3.868371468976837*^9}},ExpressionUUID->"865f6cbf-3ec2-4cd9-bded-\
dd49e6b42038"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], "/", 
       "4202845"}], "/", "mathematica"}], "-", "using", "-", "simplify", "-", 
     "to", "-", "do", "-", "common", "-", "sub", "-", "expression", "-", 
     "elimination", "-", "and", "-", "reductio"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"stoney", ".", "sb", ".", "org"}], "/", "wordpress"}], "/", 
      "wp"}], "-", 
     RowBox[{
      RowBox[{"content", "/", "cvt2c"}], "/"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"<<", "cse.m"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"fa9c792d-b0a5-407a-a2f6-9aa80cc8dcaa"]
}, Closed]],

Cell[CellGroupData[{

Cell["Capitalization", "Subsection",
 CellChangeTimes->{{3.868439493907201*^9, 
  3.868439496307272*^9}},ExpressionUUID->"bd1150c7-3784-45a6-8438-\
3f6faabac889"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "capitalizationRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"capitalizationRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868316105323255*^9, 3.868316157929685*^9}, {
   3.868316230109397*^9, 3.868316306948285*^9}, {3.86831634177719*^9, 
   3.86831635056705*^9}, {3.868316425275738*^9, 3.868316537946056*^9}, {
   3.868316591092558*^9, 3.868316597142627*^9}, {3.8683166621718187`*^9, 
   3.8683166908708763`*^9}, {3.868371896499003*^9, 3.8683719011111813`*^9}, {
   3.868375787792369*^9, 3.86837583159341*^9}, {3.868381925961285*^9, 
   3.868381934913391*^9}, {3.8683968959356737`*^9, 3.8683970125234003`*^9}, {
   3.8684004316580677`*^9, 3.868400458276379*^9}, {3.868400961138571*^9, 
   3.868400962018216*^9}, {3.8684011791176558`*^9, 3.868401187714568*^9}, {
   3.868401291792986*^9, 3.868401466970656*^9}, {3.868401504491877*^9, 
   3.8684015112202682`*^9}, 3.868439343095846*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"147a9c50-f48d-41d1-8e2e-87ab4360e989"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory", "Subsection",
 CellChangeTimes->{{3.8684844615092793`*^9, 
  3.868484465568892*^9}},ExpressionUUID->"bb4cabbe-4c1f-4868-844c-\
2d689adb8077"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "trajectoryRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trajectoryRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<s(1,1,t)\>\"", "\[Rule]", "\"\<sx(1,t)\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<s(1,2,t)\>\"", "\[Rule]", "\"\<sy(1,t)\>\""}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<s(2,1,t)\>\"", "\[Rule]", "\"\<sx(2,t)\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<s(2,2,t)\>\"", "\[Rule]", "\"\<sy(2,t)\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868484474842311*^9, 3.868484505457848*^9}, {
  3.868484566826496*^9, 3.868484616554707*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"86b0f729-b49e-483f-bef0-77fdcf4b4757"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory derivative rules", "Subsection",
 CellChangeTimes->{{3.8684846680229*^9, 
  3.8684846728027983`*^9}},ExpressionUUID->"e4a8b6af-ce24-4ebe-b7df-\
aafffb17d9d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "trajectoryDerivRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trajectoryDerivRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<Derivative(0,0,1)(s)(1,1,t)\>\"", "\[Rule]", 
      "\"\<dsx_dt(1,t)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1)(s)(1,2,t)\>\"", "\[Rule]", 
      "\"\<dsy_dt(1,t)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1)(s)(2,1,t)\>\"", "\[Rule]", 
      "\"\<dsx_dt(2,t)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1)(s)(2,2,t)\>\"", "\[Rule]", 
      "\"\<dsy_dt(2,t)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,2)(s)(1,1,t)\>\"", "\[Rule]", 
      "\"\<d2sx_dt2(1,t)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,2)(s)(1,2,t)\>\"", "\[Rule]", 
      "\"\<d2sy_dt2(1,t)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,2)(s)(2,1,t)\>\"", "\[Rule]", 
      "\"\<d2sx_dt2(2,t)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,2)(s)(2,2,t)\>\"", "\[Rule]", 
      "\"\<d2sy_dt2(2,t)\>\""}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8684846813733253`*^9, 3.8684847247217607`*^9}, {
  3.868485354925947*^9, 3.868485371446154*^9}, {3.868547438372093*^9, 
  3.868547457021862*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"d1cd63be-21fe-429b-ba58-b15c8aa67195"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kerr schild functions", "Subsection",
 CellChangeTimes->{{3.8684870717307777`*^9, 
  3.8684870754406137`*^9}},ExpressionUUID->"3742924f-35e8-45c1-acde-\
7bb9c9dd75ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ksRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ksRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<H\>\"", "\[Rule]", "\"\<H_KS\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<l2\>\"", "\[Rule]", "\"\<l1_KS\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<l3\>\"", "\[Rule]", "\"\<l2_KS\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<l4\>\"", "\[Rule]", "\"\<l3_KS\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868487097081666*^9, 3.868487158058959*^9}, {
  3.8685466344869137`*^9, 3.868546635596283*^9}, {3.8685473480124493`*^9, 
  3.868547349322267*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"79dd37b4-d01d-472c-aaee-a1390b870869"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kerr schild functions derivative", "Subsection",
 CellChangeTimes->{{3.8684870717307777`*^9, 3.8684870754406137`*^9}, {
  3.868546282262673*^9, 
  3.868546286422804*^9}},ExpressionUUID->"1874014e-d625-46c8-8692-\
f4b02cdcabf0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ksDerivRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ksDerivRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<Derivative(0,0,1,0,0)(H_KS)\>\"", "\[Rule]", "\"\<dH_KS_dX\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1,0)(H_KS)\>\"", "\[Rule]", "\"\<dH_KS_dY\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1)(H_KS)\>\"", "\[Rule]", "\"\<dH_KS_dZ\>\""}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,1,0,0)(l1_KS)\>\"", "\[Rule]", "\"\<dl1_KS_dX\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0)(l1_KS)\>\"", "\[Rule]", "\"\<dl1_KS_dY\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1)(l1_KS)\>\"", "\[Rule]", "\"\<dl1_KS_dZ\>\""}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,1,0,0)(l2_KS)\>\"", "\[Rule]", "\"\<dl2_KS_dX\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0)(l2_KS)\>\"", "\[Rule]", "\"\<dl2_KS_dY\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1)(l2_KS)\>\"", "\[Rule]", "\"\<dl2_KS_dZ\>\""}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,1,0,0)(l3_KS)\>\"", "\[Rule]", "\"\<dl3_KS_dX\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1,0)(l3_KS)\>\"", "\[Rule]", "\"\<dl3_KS_dY\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,1)(l3_KS)\>\"", "\[Rule]", "\"\<dl3_KS_dZ\>\""}]}],
     "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868487097081666*^9, 3.868487158058959*^9}, {
  3.868546298401651*^9, 3.8685463189922037`*^9}, {3.868546350752412*^9, 
  3.868546363242334*^9}, {3.8685464213302183`*^9, 3.868546458023291*^9}, {
  3.868546503169821*^9, 3.868546618466544*^9}, {3.868547294403957*^9, 
  3.868547298853428*^9}, {3.868566412846994*^9, 3.8685664223559237`*^9}, {
  3.872121644866308*^9, 
  3.872121646805435*^9}},ExpressionUUID->"feee99de-2ef4-48c8-93c0-\
9bff5ee40e8d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinate transform rules", "Subsection",
 CellChangeTimes->{{3.8685659715680447`*^9, 3.868565997977545*^9}, {
  3.8703584053083963`*^9, 
  3.870358405428411*^9}},ExpressionUUID->"a623d8c3-01b2-4419-8152-\
8db67cc6fc0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "coordTransfRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordTransfRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<eqT\>\"", "\[Rule]", "\"\<T\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<eqX\>\"", "\[Rule]", "\"\<X\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<eqY\>\"", "\[Rule]", "\"\<Y\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<eqZ\>\"", "\[Rule]", "\"\<Z\>\""}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868565980646309*^9, 3.86856607547605*^9}, {
  3.8685661639550753`*^9, 3.868566165303603*^9}, {3.8703584165209503`*^9, 
  3.8703584562714787`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"c51275a6-88d2-4a1e-9d53-859341442687"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinate transform derivative rules", "Subsection",
 CellChangeTimes->{{3.8685659715680447`*^9, 
  3.868565997977545*^9}},ExpressionUUID->"c5038e68-35e0-498d-9618-\
d339d1548100"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "coordTransfDerivRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordTransfDerivRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Derivative(0,1,0,0,0)(T)\>\"", "\[Rule]", "\"\<dT_dt\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,1,0,0)(T)\>\"", "\[Rule]", "\"\<dT_dx\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,0,1,0)(T)\>\"", "\[Rule]", "\"\<dT_dy\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,0,0,1)(T)\>\"", "\[Rule]", "\"\<dT_dz\>\""}],
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,1,0,0,0)(X)\>\"", "\[Rule]", "\"\<dX_dt\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,1,0,0)(X)\>\"", "\[Rule]", "\"\<dX_dx\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,0,1,0)(X)\>\"", "\[Rule]", "\"\<dX_dy\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,0,0,1)(X)\>\"", "\[Rule]", "\"\<dX_dz\>\""}],
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,1,0,0,0)(Y)\>\"", "\[Rule]", "\"\<dY_dt\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,1,0,0)(Y)\>\"", "\[Rule]", "\"\<dY_dx\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,0,1,0)(Y)\>\"", "\[Rule]", "\"\<dY_dy\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,0,0,1)(Y)\>\"", "\[Rule]", "\"\<dY_dz\>\""}],
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,1,0,0,0)(Z)\>\"", "\[Rule]", "\"\<dZ_dt\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,1,0,0)(Z)\>\"", "\[Rule]", "\"\<dZ_dx\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivative(0,0,0,1,0)(Z)\>\"", "\[Rule]", "\"\<dZ_dy\>\""}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,0,0,1)(Z)\>\"", "\[Rule]", "\"\<dZ_dz\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868565980646309*^9, 3.86856607547605*^9}, {
  3.8685661639550753`*^9, 3.868566165303603*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"03ac1245-a01e-4084-811d-f7fe089ca560"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["4 - Metric", "Section",
 CellChangeTimes->{{3.868482316062101*^9, 
  3.868482321392345*^9}},ExpressionUUID->"eedbedb9-c140-497a-b81c-\
47324a01d5ac"],

Cell[CellGroupData[{

Cell["Trajectory Parameters", "Subsection",
 CellChangeTimes->{{3.861117175300764*^9, 3.861117176651064*^9}, {
  3.868312539238172*^9, 
  3.868312540807959*^9}},ExpressionUUID->"bea3b258-a19e-49c3-87a9-\
6a08518ef513"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"v", ",", "v2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"bhIdx_", ",", "1"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], ",", "t"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"bhIdx_", ",", "2"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], ",", "t"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"bhIdx_", ",", "3"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v2", "[", "bhIdx_", "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"bhIdx", ",", "1"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"bhIdx", ",", "2"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"bhIdx", ",", "3"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "n", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"bhIdx_", ",", "1"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"bhIdx", ",", "1"}], "]"}], "/", 
     SqrtBox[
      RowBox[{"v2", "[", "bhIdx", "]"}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"bhIdx_", ",", "2"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"bhIdx", ",", "2"}], "]"}], "/", 
     SqrtBox[
      RowBox[{"v2", "[", "bhIdx", "]"}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"n", "[", 
     RowBox[{"bhIdx_", ",", "3"}], "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"bhIdx", ",", "3"}], "]"}], "/", 
      SqrtBox[
       RowBox[{"v2", "[", "bhIdx", "]"}]]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\[Gamma]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "bhIdx_", "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     FractionBox["1", 
      SqrtBox[
       RowBox[{"1", "-", 
        RowBox[{"v2", "[", "bhIdx", "]"}]}]]], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"b", ">", "0"}], ",", 
       RowBox[{"M1", ">", "0"}], ",", 
       RowBox[{"M2", ">", "0"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.865524415966897*^9, 3.86552450094634*^9}, {
   3.865524535705659*^9, 3.865524577444357*^9}, {3.8655246263548803`*^9, 
   3.8655247221620207`*^9}, {3.8655247587139597`*^9, 3.865524763002427*^9}, {
   3.865524836472784*^9, 3.865524854740614*^9}, {3.8655257699381237`*^9, 
   3.865525797397901*^9}, {3.865525836069531*^9, 3.865525920534947*^9}, {
   3.8655259535456867`*^9, 3.8655260364731073`*^9}, {3.8655261499617853`*^9, 
   3.8655262074301443`*^9}, {3.865526268380827*^9, 3.865526340467456*^9}, {
   3.8656428148073187`*^9, 3.865643058742819*^9}, {3.866726555357901*^9, 
   3.8667266368467607`*^9}, {3.86673043501088*^9, 3.866730505437317*^9}, {
   3.8667305850387707`*^9, 3.866730707203352*^9}, {3.86680872129394*^9, 
   3.866808748958291*^9}, {3.866810261959326*^9, 3.8668102701881647`*^9}, {
   3.866812240482986*^9, 3.866812249263751*^9}, 3.866812591336658*^9, {
   3.866817670121509*^9, 3.8668177369491367`*^9}, {3.866820373073388*^9, 
   3.866820388151572*^9}, 3.866820479590761*^9, {3.8668367698413067`*^9, 
   3.866836824467847*^9}, {3.866838253643696*^9, 3.866838258861363*^9}, {
   3.8668433938138447`*^9, 3.86684343260563*^9}, {3.866843566561852*^9, 
   3.8668436077288733`*^9}, {3.866843639518705*^9, 3.866843640959424*^9}, {
   3.8668461263282957`*^9, 3.866846131606632*^9}, {3.8681135914439793`*^9, 
   3.8681136278999453`*^9}, {3.868128508421637*^9, 3.868128528141382*^9}, {
   3.8683123424645777`*^9, 3.868312365057095*^9}, {3.8683123985045147`*^9, 
   3.868312403733046*^9}, {3.868312519773333*^9, 3.8683125321105328`*^9}, {
   3.868482449212385*^9, 3.868482450281295*^9}, {3.868484256585382*^9, 
   3.8684842574242764`*^9}, 3.870355180860618*^9, 3.870355224473658*^9, {
   3.870908055277836*^9, 3.870908070326686*^9}, 3.870908271843292*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"435096a1-0604-4b9a-ac01-fa0009db88df"]
}, Closed]],

Cell[CellGroupData[{

Cell["Lorentz Boost", "Subsection",
 CellChangeTimes->{{3.865468244320264*^9, 
  3.8654682473304043`*^9}},ExpressionUUID->"36752436-f1d2-4593-8efd-\
8291ec0937ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\[CapitalLambda]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]", "[", "bhIdx_", "]"}], ":=", 
   RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Gamma]", "[", "bhIdx", "]"}]}], "*", 
         RowBox[{"v", "[", 
          RowBox[{"bhIdx", ",", "1"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Gamma]", "[", "bhIdx", "]"}]}], "*", 
         RowBox[{"v", "[", 
          RowBox[{"bhIdx", ",", "2"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Gamma]", "[", "bhIdx", "]"}]}], "*", 
         RowBox[{"v", "[", 
          RowBox[{"bhIdx", ",", "3"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Gamma]", "[", "bhIdx", "]"}]}], "*", 
         RowBox[{"v", "[", 
          RowBox[{"bhIdx", ",", "1"}], "]"}]}], ",", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
          RowBox[{"n", "[", 
           RowBox[{"bhIdx", ",", "1"}], "]"}], 
          RowBox[{"n", "[", 
           RowBox[{"bhIdx", ",", "1"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "1"}], "]"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "2"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "1"}], "]"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "3"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Gamma]", "[", "bhIdx", "]"}]}], "*", 
         RowBox[{"v", "[", 
          RowBox[{"bhIdx", ",", "2"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "2"}], "]"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "1"}], "]"}]}], ",", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
          RowBox[{"n", "[", 
           RowBox[{"bhIdx", ",", "2"}], "]"}], 
          RowBox[{"n", "[", 
           RowBox[{"bhIdx", ",", "2"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "2"}], "]"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "3"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Gamma]", "[", "bhIdx", "]"}]}], "*", 
         RowBox[{"v", "[", 
          RowBox[{"bhIdx", ",", "3"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "3"}], "]"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "1"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "3"}], "]"}], 
         RowBox[{"n", "[", 
          RowBox[{"bhIdx", ",", "2"}], "]"}]}], ",", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
          RowBox[{"n", "[", 
           RowBox[{"bhIdx", ",", "3"}], "]"}], 
          RowBox[{"n", "[", 
           RowBox[{"bhIdx", ",", "3"}], "]"}]}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.865468249345998*^9, 3.865468360068568*^9}, {
   3.865468599315675*^9, 3.8654686927924*^9}, {3.865468725532305*^9, 
   3.865468745012939*^9}, {3.865643189802102*^9, 3.8656432192703247`*^9}, {
   3.865643287768907*^9, 3.865643439976343*^9}, {3.866726854623457*^9, 
   3.866726864592852*^9}, {3.8668456981980867`*^9, 3.86684570029672*^9}, {
   3.866846302103363*^9, 3.866846311231977*^9}, {3.868113637369336*^9, 
   3.868113654541634*^9}, {3.868484214087887*^9, 3.868484223076269*^9}, {
   3.87090809524756*^9, 3.870908137079342*^9}, 3.870908248415543*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"e10e0cab-ff4d-4d74-b62a-a7dc31276209"]
}, Closed]],

Cell[CellGroupData[{

Cell["Boosted \[ScriptCapitalH]", "Subsection",
 CellChangeTimes->{{3.8656473644295187`*^9, 
  3.865647375989092*^9}},ExpressionUUID->"0f506c05-a7f6-4ffc-bd70-\
27da0789fab7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "boostedL", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boostedL", "[", 
    RowBox[{"bhIdx_", ",", "a_", ",", "X_", ",", "Y_", ",", "Z_", ",", "1"}], 
    "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l2", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l3", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l4", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boostedL", "[", 
    RowBox[{"bhIdx_", ",", "a_", ",", "X_", ",", "Y_", ",", "Z_", ",", "2"}], 
    "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l2", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l3", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l4", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boostedL", "[", 
    RowBox[{"bhIdx_", ",", "a_", ",", "X_", ",", "Y_", ",", "Z_", ",", "3"}], 
    "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l2", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l3", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], 
      RowBox[{"l4", "[", 
       RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"boostedL", "[", 
     RowBox[{"bhIdx_", ",", "a_", ",", "X_", ",", "Y_", ",", "Z_", ",", "4"}],
      "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], 
       RowBox[{"l2", "[", 
        RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], 
       RowBox[{"l3", "[", 
        RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalLambda]", "[", "bhIdx", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}], 
       RowBox[{"l4", "[", 
        RowBox[{"a", ",", "X", ",", "Y", ",", "Z"}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "boosted\[ScriptCapitalH]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boosted\[ScriptCapitalH]", "[", 
    RowBox[{
    "bhIdx_", ",", "M_", ",", "a_", ",", "X_", ",", "Y_", ",", "Z_", ",", 
     "AA_", ",", "BB_"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"M", ",", "a", ",", "X", ",", "Y", ",", "Z"}], "]"}], 
     RowBox[{"boostedL", "[", 
      RowBox[{"bhIdx", ",", "a", ",", "X", ",", "Y", ",", "Z", ",", "AA"}], 
      "]"}], 
     RowBox[{"boostedL", "[", 
      RowBox[{"bhIdx", ",", "a", ",", "X", ",", "Y", ",", "Z", ",", "BB"}], 
      "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.865647378309247*^9, 3.8656474789568663`*^9}, {
   3.8656475308485203`*^9, 3.865647563624443*^9}, {3.866814858248176*^9, 
   3.86681486455652*^9}, {3.8668158876457376`*^9, 3.866815893034609*^9}, {
   3.8668159739729958`*^9, 3.8668159770127974`*^9}, {3.866818099365725*^9, 
   3.866818123961781*^9}, {3.866818205340076*^9, 3.866818242178976*^9}, {
   3.8668184126967907`*^9, 3.86681841808622*^9}, {3.86682005795782*^9, 
   3.866820058556148*^9}, {3.866820118205474*^9, 3.866820146094963*^9}, {
   3.866820290432303*^9, 3.866820292921397*^9}, {3.866823936585787*^9, 
   3.8668239386252947`*^9}, {3.866824039004294*^9, 3.866824042886331*^9}, {
   3.866824927298774*^9, 3.86682495990772*^9}, {3.866826806982519*^9, 
   3.866826808781515*^9}, {3.866826994548962*^9, 3.86682701179856*^9}, {
   3.866827409380694*^9, 3.8668275817173557`*^9}, {3.866827612596919*^9, 
   3.866827666785266*^9}, {3.866827950551259*^9, 3.866827954939988*^9}, {
   3.866835762527944*^9, 3.866835903139186*^9}, {3.8668359705460367`*^9, 
   3.8668360150280647`*^9}, 3.8668362836701193`*^9, {3.866844227896179*^9, 
   3.8668442479341393`*^9}, {3.866846322092873*^9, 3.866846340311244*^9}, {
   3.868113782917631*^9, 3.8681137897195873`*^9}, {3.8681285645108833`*^9, 
   3.868128575761257*^9}, {3.868128807585561*^9, 3.868128814037709*^9}, {
   3.8684860673323*^9, 3.868486099380665*^9}, {3.868486169710091*^9, 
   3.868486184678617*^9}, {3.8685472625358543`*^9, 3.8685472800751343`*^9}, {
   3.868547318224504*^9, 3.8685473327637787`*^9}, {3.870355329301648*^9, 
   3.87035536337929*^9}, {3.8709083007725286`*^9, 3.870908301553442*^9}, {
   3.8709083538006973`*^9, 3.8709083596308117`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"5b7667f1-d45c-47c6-89f5-cb4cb6b3d952"]
}, Closed]],

Cell[CellGroupData[{

Cell["4-metric assembly", "Subsection",
 CellChangeTimes->{{3.861203967988662*^9, 
  3.861203971268839*^9}},ExpressionUUID->"bd24b7a1-42e4-408d-9b78-\
71c1ef99e57b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "llgSKS", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"llgSKS", "=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Eta]", ",", "bh1", ",", "bh2", ",", "i", ",", "j"}], "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bh1", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "4"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "4"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"bh1", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"FullSimplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"boosted\[ScriptCapitalH]", "[", 
                RowBox[{
                "1", ",", "M", ",", "a", ",", "X", ",", "Y", ",", "Z", ",", 
                 "i", ",", "j"}], "]"}], "//.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"M", "\[Rule]", "M1"}], ",", 
                 RowBox[{"a", "\[Rule]", "a1"}]}], "}"}]}], "//.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"X", "\[Rule]", 
                 RowBox[{"eqX", "[", 
                  RowBox[{"1", ",", "t", ",", "x", ",", "y", ",", "z"}], 
                  "]"}]}], ",", 
                RowBox[{"Y", "\[Rule]", 
                 RowBox[{"eqY", "[", 
                  RowBox[{"1", ",", "t", ",", "x", ",", "y", ",", "z"}], 
                  "]"}]}], ",", 
                RowBox[{"Z", "\[Rule]", 
                 RowBox[{"eqZ", "[", 
                  RowBox[{"1", ",", "t", ",", "x", ",", "y", ",", "z"}], 
                  "]"}]}]}], "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bh2", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "4"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "4"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"bh2", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"FullSimplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"boosted\[ScriptCapitalH]", "[", 
                RowBox[{
                "2", ",", "M", ",", "a", ",", "X", ",", "Y", ",", "Z", ",", 
                 "i", ",", "j"}], "]"}], "//.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"M", "\[Rule]", "M2"}], ",", 
                 RowBox[{"a", "\[Rule]", "a2"}]}], "}"}]}], "//.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"X", "\[Rule]", 
                 RowBox[{"eqX", "[", 
                  RowBox[{"2", ",", "t", ",", "x", ",", "y", ",", "z"}], 
                  "]"}]}], ",", 
                RowBox[{"Y", "\[Rule]", 
                 RowBox[{"eqY", "[", 
                  RowBox[{"2", ",", "t", ",", "x", ",", "y", ",", "z"}], 
                  "]"}]}], ",", 
                RowBox[{"Z", "\[Rule]", 
                 RowBox[{"eqZ", "[", 
                  RowBox[{"2", ",", "t", ",", "x", ",", "y", ",", "z"}], 
                  "]"}]}]}], "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"\[Eta]", "+", "bh1", "+", "bh2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.861214198023122*^9, 3.861214218191215*^9}, {
   3.861214406844845*^9, 3.8612144807930603`*^9}, {3.861232332362925*^9, 
   3.8612323986409683`*^9}, {3.8612324591427107`*^9, 3.861232665651525*^9}, {
   3.8612326961995773`*^9, 3.8612329333174343`*^9}, {3.861233000167461*^9, 
   3.8612330033468018`*^9}, {3.86123304404681*^9, 3.8612330578966303`*^9}, {
   3.861233095374798*^9, 3.86123311561348*^9}, {3.861233149250637*^9, 
   3.861233181387703*^9}, {3.861233422893813*^9, 3.861233432232362*^9}, {
   3.861235150000181*^9, 3.8612352476772127`*^9}, 3.8612353119107523`*^9, {
   3.861235367758133*^9, 3.8612353682263803`*^9}, {3.861910628170557*^9, 
   3.861910678698352*^9}, {3.861910730255834*^9, 3.861910776842757*^9}, {
   3.861910818480976*^9, 3.861910825370202*^9}, {3.8619108611298532`*^9, 
   3.861910866348127*^9}, {3.861910925147826*^9, 3.861910939997694*^9}, {
   3.861910991335287*^9, 3.861910993784485*^9}, {3.862414525739798*^9, 
   3.86241457709769*^9}, {3.862414631666744*^9, 3.862414696905101*^9}, {
   3.862414727030507*^9, 3.8624148671834927`*^9}, {3.865013026873619*^9, 
   3.86501302761779*^9}, {3.865013105702722*^9, 3.8650131086687326`*^9}, {
   3.86535198019002*^9, 3.8653519873189898`*^9}, {3.86535279032789*^9, 
   3.865352812344174*^9}, {3.865359120067219*^9, 3.8653591206841373`*^9}, {
   3.865433323227047*^9, 3.865433451905299*^9}, {3.865433488195641*^9, 
   3.865433530425619*^9}, {3.865433590782172*^9, 3.865433592458993*^9}, {
   3.865469135034416*^9, 3.8654691458327513`*^9}, {3.86564600583885*^9, 
   3.865646026177759*^9}, {3.865646578516676*^9, 3.865646579846388*^9}, {
   3.8656467932124643`*^9, 3.865646884851976*^9}, {3.865647100207974*^9, 
   3.865647108186438*^9}, {3.865647303422084*^9, 3.865647325542205*^9}, 
   3.8656473588824*^9, {3.8656475770354967`*^9, 3.8656477745971527`*^9}, {
   3.865647807555604*^9, 3.865647903768586*^9}, {3.865647961561305*^9, 
   3.865647969031136*^9}, {3.866816911109275*^9, 3.866816915329042*^9}, {
   3.866817136584443*^9, 3.866817139814*^9}, {3.866818698520643*^9, 
   3.8668187912827597`*^9}, {3.8668188243595133`*^9, 3.866818869340055*^9}, {
   3.866818973821392*^9, 3.8668189868977547`*^9}, {3.866819060178199*^9, 
   3.866819064947411*^9}, {3.866819209544312*^9, 3.866819236844933*^9}, {
   3.866819286677269*^9, 3.866819297075508*^9}, {3.866819343815485*^9, 
   3.866819387511808*^9}, {3.866819579607584*^9, 3.8668195870872307`*^9}, {
   3.866819650556964*^9, 3.8668196548765*^9}, {3.8668200634189577`*^9, 
   3.866820092426619*^9}, {3.866824327310947*^9, 3.866824330760445*^9}, {
   3.866827120187018*^9, 3.866827121826496*^9}, {3.866846225075459*^9, 
   3.866846231784719*^9}, {3.866846346852791*^9, 3.8668463515221157`*^9}, {
   3.8681140796029673`*^9, 3.86811407991437*^9}, {3.868114870497032*^9, 
   3.868114879355521*^9}, {3.86812283727346*^9, 3.8681228416605864`*^9}, {
   3.868545510359291*^9, 3.868545514038464*^9}, {3.868545613176674*^9, 
   3.868545660825683*^9}, {3.870355544040118*^9, 3.87035554535728*^9}, {
   3.8703577508483353`*^9, 3.870357796113658*^9}, {3.8709086712860603`*^9, 
   3.8709086741757517`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"a190b50e-70d5-4a04-9c44-d1fb00f0166e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric components codegen", "Section",
 CellChangeTimes->{{3.868484318022434*^9, 3.868484318712276*^9}, {
  3.8684882430264673`*^9, 
  3.868488249646393*^9}},ExpressionUUID->"8876be30-6fdf-4ad0-b0b0-\
3b2f6e529aa8"],

Cell[CellGroupData[{

Cell["Genereting function", "Subsection",
 CellChangeTimes->{{3.868488255176363*^9, 
  3.868488258736332*^9}},ExpressionUUID->"3cb637c0-587e-4093-bd7e-\
bf82d750d5bc"],

Cell[CellGroupData[{

Cell["Metric component", "Subsubsection",
 CellChangeTimes->{{3.870358780181217*^9, 
  3.870358783660842*^9}},ExpressionUUID->"44bce19c-130c-4a1f-b53f-\
23d590c0cc38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "genMetricComponent", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genMetricComponent", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"str", ",", "cse", ",", "expr", ",", "var", ",", "name"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{
       "\"\<#include \\\"SKS.hpp\\\"\n#include \\\"aux_functions.hpp\\\"\n\n\
auto grlensing::SKS::llgSKS_\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}], "<>", 
        "\"\<(double t, double x, double y, double z) const noexcept -> \
double {\n\n  using namespace sks_aux;\n  using std::sqrt;\n  using std::pow;\
\n\n\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cse", "=", 
       RowBox[{"hoistCommonSubexpressions", "[", 
        RowBox[{"llgSKS", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", 
          RowBox[{"j", "+", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"expr", "=", 
       RowBox[{
       "cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "=", 
          RowBox[{"List", "@@", 
           RowBox[{"cse", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "k"}], "\[RightDoubleBracket]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"str", "=", 
          RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  return \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"expr", ",", "CForm"}], "]"}], "<>", "\"\<;\\n}\>\""}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "ksRules"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "coordTransfRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "coordTransfDerivRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "trajectoryRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "trajectoryDerivRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"name", "=", 
       RowBox[{"\"\<g\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<.cpp\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"name", ",", "str", ",", "\"\<Text\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{"\"\<clang-format -i \>\"", "<>", "name"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{
       "\"\<mv \>\"", "<>", "name", "<>", 
        "\"\< ../../plugins/metrics/SKS/source\>\""}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8703579283512497`*^9, 3.870357929469747*^9}, {
   3.870358088740513*^9, 3.870358099066166*^9}, {3.870358171454412*^9, 
   3.870358267162958*^9}, {3.8703582981247263`*^9, 3.870358308272747*^9}, {
   3.8703583637424793`*^9, 3.87035836829154*^9}, {3.87035847619989*^9, 
   3.870358480103232*^9}, {3.870358538727667*^9, 3.870358579339747*^9}, {
   3.870358711934898*^9, 3.870358725344108*^9}, 3.870358769362938*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"e295a0f2-0705-4c30-96bd-245dcb56f107"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric component derivative", "Subsubsection",
 CellChangeTimes->{{3.870358799559901*^9, 
  3.870358803439851*^9}},ExpressionUUID->"d442c503-ecb1-41aa-9824-\
c1d45f40f2d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "genMetricComponentDerivative", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genMetricComponentDerivative", "[", 
    RowBox[{"i_", ",", "j_", ",", "dvar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"str", ",", "cse", ",", "expr", ",", "var", ",", "name"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{
       "\"\<#include \\\"SKS.hpp\\\"\n#include \\\"aux_functions.hpp\\\"\n\n\
auto grlensing::SKS::dllgSKS_\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<_d\>\"", "<>", 
        RowBox[{"ToString", "[", "dvar", "]"}], "<>", 
        "\"\<(double t, double x, double y, double z) const noexcept -> \
double {\n\n  using namespace sks_aux;\n  using std::sqrt;\n  using std::pow;\
\n\n\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cse", "=", 
       RowBox[{"hoistCommonSubexpressions", "[", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"llgSKS", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"j", "+", "1"}]}], "\[RightDoubleBracket]"}], ",", 
          "dvar"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"expr", "=", 
       RowBox[{
       "cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "=", 
          RowBox[{"List", "@@", 
           RowBox[{"cse", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "k"}], "\[RightDoubleBracket]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"str", "=", 
          RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  return \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"expr", ",", "CForm"}], "]"}], "<>", "\"\<;\\n}\>\""}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "ksRules"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "ksDerivRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "coordTransfRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "coordTransfDerivRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "trajectoryRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "trajectoryDerivRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"name", "=", 
       RowBox[{"\"\<dg\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<_d\>\"", "<>", 
        RowBox[{"ToString", "[", "dvar", "]"}], "<>", "\"\<.cpp\>\""}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"name", ",", "str", ",", "\"\<Text\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{"\"\<clang-format -i \>\"", "<>", "name"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{
       "\"\<mv \>\"", "<>", "name", "<>", 
        "\"\< ../../plugins/metrics/SKS/source\>\""}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868485487506357*^9, 3.868485550601577*^9}, {
   3.868485586682437*^9, 3.868485742458243*^9}, {3.868485786287992*^9, 
   3.8684858184171*^9}, {3.8684865533323402`*^9, 3.868486558330749*^9}, {
   3.868486657270918*^9, 3.868486659599221*^9}, {3.868486816737585*^9, 
   3.868486820465933*^9}, {3.868486864946609*^9, 3.868487022533046*^9}, {
   3.8684871660206413`*^9, 3.8684871731599617`*^9}, 3.86848735602656*^9, {
   3.868487504524808*^9, 3.868487536872937*^9}, {3.8684875679225883`*^9, 
   3.868487571291821*^9}, {3.8684876490015697`*^9, 3.868487659130623*^9}, {
   3.868487689220093*^9, 3.868487815197607*^9}, {3.868487883016389*^9, 
   3.868487885775139*^9}, {3.868487932365218*^9, 3.8684879349141617`*^9}, {
   3.868488538482785*^9, 3.8684886254810534`*^9}, {3.868488699310775*^9, 
   3.868488714290896*^9}, {3.868488780050754*^9, 3.8684887848393297`*^9}, {
   3.868546471341316*^9, 3.868546478301269*^9}, {3.8685660990474777`*^9, 
   3.86856610773669*^9}, {3.86856621220612*^9, 3.8685662144978456`*^9}, {
   3.870357982600349*^9, 3.870357986749736*^9}, {3.870358084430891*^9, 
   3.870358086416567*^9}, {3.870358792529283*^9, 3.870358826104862*^9}, {
   3.870358895260354*^9, 3.870358933110922*^9}, {3.870359207324297*^9, 
   3.8703592310935383`*^9}, {3.870359278073247*^9, 3.870359283652792*^9}, {
   3.870359419650165*^9, 3.8703594223592577`*^9}, {3.8703595010296297`*^9, 
   3.8703595016791763`*^9}, {3.870359532788796*^9, 3.8703595347581253`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"44ac459e-3b5a-467f-a9bf-5c0b747a413e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generation calls", "Subsection",
 CellChangeTimes->{{3.868488264276366*^9, 
  3.868488268196279*^9}},ExpressionUUID->"90e650f6-31f3-4509-8fa7-\
b5de9c6802c5"],

Cell[CellGroupData[{

Cell["metric", "Subsubsection",
 CellChangeTimes->{{3.868567052759581*^9, 
  3.868567053819512*^9}},ExpressionUUID->"d56604b1-f0d6-4310-a769-\
8c4fbe9a2305"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"i", "\[LessEqual]", "j"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"genMetricComponent", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<completed \>\"", ",", "i", ",", "\"\<  \>\"", ",", "j"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.868485684398924*^9, 3.8684856910888357`*^9}, {
   3.868487250367488*^9, 3.868487274777463*^9}, {3.868487334386146*^9, 
   3.868487364735342*^9}, {3.86848754357373*^9, 3.868487547024659*^9}, {
   3.868487756348421*^9, 3.8684877747474537`*^9}, 3.868487835625185*^9, {
   3.868488404344021*^9, 3.868488425873274*^9}, {3.8685682159293137`*^9, 
   3.868568232057723*^9}, {3.870359008047019*^9, 3.870359040036139*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"040b0ede-cf47-4538-99f3-3de73d67efad"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["completed ", 0, "  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.870359595450571*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"b2c788ba-260f-4772-9d98-535846432aaa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed ", 0, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.870359595724103*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"979da7e3-ec78-49ce-be45-8ad668397272"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed ", 0, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.8703595961520042`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"0a2603b5-88cf-48c7-ac09-6fde31f2a34c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed ", 0, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.870359596218251*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"d1995b7e-615e-4c41-9ab5-723121e1e418"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed ", 1, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.870359596878957*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"b367ae8c-b8b7-4fb4-bb27-0115e05ee055"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed ", 1, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.870359597580798*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"de1dbfe2-0805-4d40-ac34-09e8c9ca0645"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed ", 1, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.870359597712261*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"685a7065-1d06-46d1-b3f8-6c30393f2837"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed ", 2, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.870359598461152*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"1dec362f-46e1-44dd-8ba6-e18dae341f25"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed ", 2, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.8703595985640078`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"c687190e-4c42-48a3-a414-fa39ba463708"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed ", 3, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868568242834238*^9, 3.8686261140168324`*^9, 
  3.868633490347806*^9, 3.870359045845223*^9, 3.87035924412022*^9, 
  3.870359598624371*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"340f0ff2-d05c-4c96-916a-00374b12949b"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["metric derivative", "Subsubsection",
 CellChangeTimes->{{3.868567057369706*^9, 
  3.868567061909566*^9}},ExpressionUUID->"6f73d63c-6237-4356-a3ca-\
077d94cda7e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"i", "\[LessEqual]", "j"}], ",", 
     RowBox[{
      RowBox[{"genMetricComponentDerivative", "[", 
       RowBox[{"i", ",", "j", ",", "t"}], "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<completed t \>\"", ",", "i", ",", "\"\<  \>\"", ",", "j"}], "]"}],
       ";", 
      RowBox[{"genMetricComponentDerivative", "[", 
       RowBox[{"i", ",", "j", ",", "x"}], "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<completed x \>\"", ",", "i", ",", "\"\<  \>\"", ",", "j"}], "]"}],
       ";", 
      RowBox[{"genMetricComponentDerivative", "[", 
       RowBox[{"i", ",", "j", ",", "y"}], "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<completed y \>\"", ",", "i", ",", "\"\<  \>\"", ",", "j"}], "]"}],
       ";", 
      RowBox[{"genMetricComponentDerivative", "[", 
       RowBox[{"i", ",", "j", ",", "z"}], "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<completed z \>\"", ",", "i", ",", "\"\<  \>\"", ",", "j"}], "]"}],
       ";"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.868488730017989*^9, 3.868488732158162*^9}, {
   3.868546224754109*^9, 3.868546243414021*^9}, {3.8685665364718*^9, 
   3.868566586409197*^9}, {3.8685670649715014`*^9, 3.868567100759321*^9}, {
   3.86856732269058*^9, 3.868567365816609*^9}, {3.868567515874084*^9, 
   3.8685675175644484`*^9}, {3.8685681753597803`*^9, 3.868568190129402*^9}, {
   3.868633447664815*^9, 3.8686334816529417`*^9}, {3.870359154257703*^9, 
   3.870359160575911*^9}, {3.8703595552859373`*^9, 3.8703595772050343`*^9}, 
   3.870371077229227*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"380aa94f-bfae-4a19-9e42-a301c8acd007"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["completed t ", 0, "  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870359601305575*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"34dd6044-d633-457a-8088-715a2c9dd236"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["completed x ", 0, "  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.87035960162715*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"fa5cf5f3-fb2a-41ec-b28f-80abab000fe9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["completed y ", 0, "  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870359601978716*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"a5e3e308-e441-4342-9657-63542bc95fce"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["completed z ", 0, "  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870359602352509*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"8d46bac0-f2e3-4d30-943e-3805b585d797"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed t ", 0, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703607299878674`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"c581fe9f-267b-4c91-a3d9-cd08abcf8aec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed x ", 0, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870360732264312*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"677a5032-128b-4514-8473-4668c699df6d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed y ", 0, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.87036073464502*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"0ed40e85-6fd4-4415-853c-ed0f22bb8c2d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed z ", 0, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703607369474993`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"9b3a4952-f639-49c7-a339-506e31ead6ec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed t ", 0, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.87036177053262*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"eff82ac3-b047-4939-b698-bb1d820cee48"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed x ", 0, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703617730146*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"53de1373-1533-4d70-8c2e-44d80fa7af9f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed y ", 0, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870361775379347*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"9d6f777e-e9be-489f-a053-e3f9059670f6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed z ", 0, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703617776635513`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"cbbeeec3-a4a7-45ef-820e-c9d965966586"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed t ", 0, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870361779941533*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"2299bcad-3c3e-4cfc-bc90-abfeaf12a258"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed x ", 0, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870361780090067*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"c92afe87-edf0-4b1d-9610-75bca26ddec9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed y ", 0, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870361780262298*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"9d3c4407-2290-42f1-9038-b34da4a816b1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed z ", 0, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870361780439888*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"676ceee6-15dd-47f1-bae7-c0579461771a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed t ", 1, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870363885831654*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"992202d0-30a8-4a8f-b046-de8578e4c67f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed x ", 1, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870363896366612*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"3c4ff763-e8e3-4f4f-9d49-ecd1d0d96812"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed y ", 1, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870363907034401*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"db94a1d4-2f89-4b5b-a1c9-e75d1e9e94ad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["completed z ", 1, "  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703639178540173`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"6998ea2d-9458-4900-a7e1-f6b4ca204bfd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed t ", 1, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870367204201303*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"81e402b5-913d-444a-a367-ccbc7f823d1d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed x ", 1, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703672287231903`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"df1ca7c5-da3f-43be-9f78-7b983eeae76c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed y ", 1, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.87036725332738*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"221c766a-5765-4170-afe1-723ffc8441ba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed z ", 1, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870367278119911*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"865b965f-b503-4267-97a8-ac7e72cc27d8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed t ", 1, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870367319577467*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"5527e2b1-3f35-4e03-bae4-20f2d681ac4f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed x ", 1, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703673201523046`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"0f1fdc25-d7a4-4a0d-a7f6-0bbc50372b5e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed y ", 1, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870367320734872*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"afffdc7e-7a47-4610-ba3a-7b81b5ff8b60"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed z ", 1, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870367321294071*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"dd485e97-0191-453c-9cb4-4a57524f2a89"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed t ", 2, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371016314897*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"a4153849-b285-4d7f-9c0f-bc3f14a1ed61"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed x ", 2, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703710271231737`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"1d4e2a33-4651-4051-a1f9-d19fc720ca40"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed y ", 2, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371038001626*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"76d522bf-34a9-4a54-984e-ac4f9946ae04"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["completed z ", 2, "  ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371048889512*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"33e0c512-10e9-47a1-a11f-c0f1de990805"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed t ", 2, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371074976975*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"2cb5a2d7-33f1-4e7f-b158-044b15169bcb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed x ", 2, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371075529502*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"3346f661-595c-4c5d-9c17-2a0b9020e9e3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed y ", 2, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.8703710761432133`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"cd82ac74-8ef9-4207-ab1b-e1129ab6072f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed z ", 2, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371076743541*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"34d29bf5-dea8-4859-9a84-837e1da563a5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed t \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed t ", 3, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371076972981*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"bb95373e-dcd8-4ea1-8bd5-37ee7687ea33"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed x \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed x ", 3, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371077043742*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"ff867d59-4fcd-4d9e-9208-9df418851af2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed y \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed y ", 3, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371077103539*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"ee492aa2-c4ab-49cc-863e-031aca291689"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"completed z \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["completed z ", 3, "  ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.868626120928834*^9, 3.868633497988592*^9, 
  3.870371077157784*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"5e0c249c-2aa7-4af3-8efa-01c2f7593a69"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinate transform codegen", "Title",
 CellChangeTimes->{{3.868631261679698*^9, 
  3.868631266099465*^9}},ExpressionUUID->"2613027a-7433-408c-bdb2-\
bf5ea426ba00"],

Cell[CellGroupData[{

Cell["CSE and codegen utilities", "Section",
 CellChangeTimes->{{3.868439204911605*^9, 
  3.868439214061768*^9}},ExpressionUUID->"f668ea9c-6afc-4ea8-b7a0-\
bbcbd6b16a5f"],

Cell[CellGroupData[{

Cell["CSE", "Subsection",
 CellChangeTimes->{{3.868371468625771*^9, 
  3.868371468976837*^9}},ExpressionUUID->"83a0fd7b-dfc0-4091-8b40-\
d06edf483805"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], "/", 
       "4202845"}], "/", "mathematica"}], "-", "using", "-", "simplify", "-", 
     "to", "-", "do", "-", "common", "-", "sub", "-", "expression", "-", 
     "elimination", "-", "and", "-", "reductio"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"stoney", ".", "sb", ".", "org"}], "/", "wordpress"}], "/", 
      "wp"}], "-", 
     RowBox[{
      RowBox[{"content", "/", "cvt2c"}], "/"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"<<", "cse.m"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"488ff88f-f920-4a54-8584-de8ab1944521"]
}, Closed]],

Cell[CellGroupData[{

Cell["Capitalization", "Subsection",
 CellChangeTimes->{{3.868439493907201*^9, 
  3.868439496307272*^9}},ExpressionUUID->"e17d89aa-44fa-472f-b154-\
9e1b16f8cec0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "capitalizationRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"capitalizationRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868316105323255*^9, 3.868316157929685*^9}, {
   3.868316230109397*^9, 3.868316306948285*^9}, {3.86831634177719*^9, 
   3.86831635056705*^9}, {3.868316425275738*^9, 3.868316537946056*^9}, {
   3.868316591092558*^9, 3.868316597142627*^9}, {3.8683166621718187`*^9, 
   3.8683166908708763`*^9}, {3.868371896499003*^9, 3.8683719011111813`*^9}, {
   3.868375787792369*^9, 3.86837583159341*^9}, {3.868381925961285*^9, 
   3.868381934913391*^9}, {3.8683968959356737`*^9, 3.8683970125234003`*^9}, {
   3.8684004316580677`*^9, 3.868400458276379*^9}, {3.868400961138571*^9, 
   3.868400962018216*^9}, {3.8684011791176558`*^9, 3.868401187714568*^9}, {
   3.868401291792986*^9, 3.868401466970656*^9}, {3.868401504491877*^9, 
   3.8684015112202682`*^9}, 3.868439343095846*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"701cff3b-b4c1-47a3-999f-c829079a9d51"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory", "Subsection",
 CellChangeTimes->{{3.8684844615092793`*^9, 
  3.868484465568892*^9}},ExpressionUUID->"4758aa4e-6ced-4357-a571-\
83427046fdc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "trajectoryRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trajectoryRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<s(bhIdx,1,t)\>\"", "\[Rule]", "\"\<sx(bhIdx,t)\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<s(bhIdx,2,t)\>\"", "\[Rule]", "\"\<sy(bhIdx,t)\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868484474842311*^9, 3.868484505457848*^9}, {
  3.868484566826496*^9, 3.868484616554707*^9}, {3.8686317904414253`*^9, 
  3.8686318145414352`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"41f7d5da-6dec-45b5-8b62-12b371cfd3ca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory derivative rules", "Subsection",
 CellChangeTimes->{{3.8684846680229*^9, 
  3.8684846728027983`*^9}},ExpressionUUID->"d0d4954d-ac56-4f6a-9ab9-\
3ff4ffdbf4e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "trajectoryDerivRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trajectoryDerivRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<Derivative(0,0,1)(s)(bhIdx,1,t)\>\"", "\[Rule]", 
      "\"\<dsx_dt(bhIdx,t)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,1)(s)(bhIdx,2,t)\>\"", "\[Rule]", 
      "\"\<dsy_dt(bhIdx,t)\>\""}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,2)(s)(bhIdx,1,t)\>\"", "\[Rule]", 
      "\"\<d2sx_dt2(bhIdx,t)\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Derivative(0,0,2)(s)(bhIdx,2,t)\>\"", "\[Rule]", 
      "\"\<d2sy_dt2(bhIdx,t)\>\""}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8684846813733253`*^9, 3.8684847247217607`*^9}, {
  3.868485354925947*^9, 3.868485371446154*^9}, {3.868547438372093*^9, 
  3.868547457021862*^9}, {3.868631831951679*^9, 3.868631864719556*^9}, {
  3.868631913449582*^9, 3.8686319238989353`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"148f2b49-15b0-4f84-8948-7a346de5f488"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory Parameters", "Section",
 CellChangeTimes->{{3.861117175300764*^9, 3.861117176651064*^9}, {
  3.868312539238172*^9, 
  3.868312540807959*^9}},ExpressionUUID->"c4e27016-b044-4cd1-8fe5-\
997e9d271404"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"v", ",", "v2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"bhIdx_", ",", "1"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], ",", "t"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"bhIdx_", ",", "2"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], ",", "t"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"bhIdx_", ",", "3"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v2", "[", "bhIdx_", "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"bhIdx", ",", "1"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"bhIdx", ",", "2"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"bhIdx", ",", "3"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "n", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"bhIdx_", ",", "1"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"bhIdx", ",", "1"}], "]"}], "/", 
     SqrtBox[
      RowBox[{"v2", "[", "bhIdx", "]"}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"bhIdx_", ",", "2"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"bhIdx", ",", "2"}], "]"}], "/", 
     SqrtBox[
      RowBox[{"v2", "[", "bhIdx", "]"}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"n", "[", 
     RowBox[{"bhIdx_", ",", "3"}], "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"bhIdx", ",", "3"}], "]"}], "/", 
      SqrtBox[
       RowBox[{"v2", "[", "bhIdx", "]"}]]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\[Gamma]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "bhIdx_", "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     FractionBox["1", 
      SqrtBox[
       RowBox[{"1", "-", 
        RowBox[{"v2", "[", "bhIdx", "]"}]}]]], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"b", ">", "0"}], ",", 
       RowBox[{"M1", ">", "0"}], ",", 
       RowBox[{"M2", ">", "0"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.865524415966897*^9, 3.86552450094634*^9}, {
   3.865524535705659*^9, 3.865524577444357*^9}, {3.8655246263548803`*^9, 
   3.8655247221620207`*^9}, {3.8655247587139597`*^9, 3.865524763002427*^9}, {
   3.865524836472784*^9, 3.865524854740614*^9}, {3.8655257699381237`*^9, 
   3.865525797397901*^9}, {3.865525836069531*^9, 3.865525920534947*^9}, {
   3.8655259535456867`*^9, 3.8655260364731073`*^9}, {3.8655261499617853`*^9, 
   3.8655262074301443`*^9}, {3.865526268380827*^9, 3.865526340467456*^9}, {
   3.8656428148073187`*^9, 3.865643058742819*^9}, {3.866726555357901*^9, 
   3.8667266368467607`*^9}, {3.86673043501088*^9, 3.866730505437317*^9}, {
   3.8667305850387707`*^9, 3.866730707203352*^9}, {3.86680872129394*^9, 
   3.866808748958291*^9}, {3.866810261959326*^9, 3.8668102701881647`*^9}, {
   3.866812240482986*^9, 3.866812249263751*^9}, 3.866812591336658*^9, {
   3.866817670121509*^9, 3.8668177369491367`*^9}, {3.866820373073388*^9, 
   3.866820388151572*^9}, 3.866820479590761*^9, {3.8668367698413067`*^9, 
   3.866836824467847*^9}, {3.866838253643696*^9, 3.866838258861363*^9}, {
   3.8668433938138447`*^9, 3.86684343260563*^9}, {3.866843566561852*^9, 
   3.8668436077288733`*^9}, {3.866843639518705*^9, 3.866843640959424*^9}, {
   3.8668461263282957`*^9, 3.866846131606632*^9}, {3.8681135914439793`*^9, 
   3.8681136278999453`*^9}, {3.868128508421637*^9, 3.868128528141382*^9}, {
   3.8683123424645777`*^9, 3.868312365057095*^9}, {3.8683123985045147`*^9, 
   3.868312403733046*^9}, {3.868312519773333*^9, 3.8683125321105328`*^9}, {
   3.868482449212385*^9, 3.868482450281295*^9}, {3.868484256585382*^9, 
   3.8684842574242764`*^9}, 3.870909084952327*^9, {3.87090951142889*^9, 
   3.870909562057205*^9}, {3.8709096174864187`*^9, 3.87090964977588*^9}, 
   3.8709099607118473`*^9, {3.8709105451002893`*^9, 3.870910546447455*^9}, {
   3.870910878541856*^9, 3.8709108796206837`*^9}, {3.870911022890492*^9, 
   3.870911023978272*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"38ace2f9-1089-423a-8623-e2ca8ddadbf3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinate transforms", "Section",
 CellChangeTimes->{{3.868546049697381*^9, 
  3.868546053757155*^9}},ExpressionUUID->"100a3ab6-5c02-481c-8d87-\
4c76e42940f5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"eqt", ",", "eqx", ",", "eqy", ",", "eqz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqt", "[", "bhIdx_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], 
    RowBox[{"(", 
     RowBox[{"T", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"bhIdx", ",", "1"}], "]"}], "X"}], "+", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"bhIdx", ",", "2"}], "]"}], "Y"}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqx", "[", "bhIdx_", "]"}], ":=", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "+", 
    RowBox[{"X", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
        RowBox[{"n", "[", 
         RowBox[{"bhIdx", ",", "1"}], "]"}], 
        RowBox[{"n", "[", 
         RowBox[{"bhIdx", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"Y", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
       RowBox[{"n", "[", 
        RowBox[{"bhIdx", ",", "1"}], "]"}], 
       RowBox[{"n", "[", 
        RowBox[{"bhIdx", ",", "2"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqy", "[", "bhIdx_", "]"}], ":=", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "+", 
    RowBox[{"X", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
       RowBox[{"n", "[", 
        RowBox[{"bhIdx", ",", "1"}], "]"}], 
       RowBox[{"n", "[", 
        RowBox[{"bhIdx", ",", "2"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"Y", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]", "[", "bhIdx", "]"}], "-", "1"}], ")"}], 
        RowBox[{"n", "[", 
         RowBox[{"bhIdx", ",", "2"}], "]"}], 
        RowBox[{"n", "[", 
         RowBox[{"bhIdx", ",", "2"}], "]"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eqz", "[", "bhIdx_", "]"}], ":=", "Z"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "local2GlobalSystem", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"local2GlobalSystem", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"eqt", "[", "bhIdx", "]"}], "\[Equal]", "t"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqx", "[", "bhIdx", "]"}], "\[Equal]", "x"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqy", "[", "bhIdx", "]"}], "\[Equal]", "y"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqz", "[", "bhIdx", "]"}], "\[Equal]", "z"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "sol", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{"local2GlobalSystem", ",", 
       RowBox[{"{", 
        RowBox[{"T", ",", "X", ",", "Y", ",", "Z"}], "}"}]}], "]"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"bhIdx", "\[Element]", "Integers"}], ",", 
      RowBox[{"\[CapitalOmega]", "\[Element]", "Reals"}]}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.865299976585465*^9, 3.865300017205639*^9}, {
   3.8653492483392763`*^9, 3.8653493228681307`*^9}, {3.8653493562462263`*^9, 
   3.8653495836594543`*^9}, {3.865349827306582*^9, 3.865349839426065*^9}, {
   3.8653498984012337`*^9, 3.865349967746372*^9}, {3.865350020486751*^9, 
   3.865350124581048*^9}, {3.865350185700589*^9, 3.865350200067225*^9}, {
   3.865350280255459*^9, 3.865350290537489*^9}, {3.865350325676355*^9, 
   3.865350404439519*^9}, {3.865350464887374*^9, 3.865350485566453*^9}, {
   3.865350571483802*^9, 3.8653505734259243`*^9}, {3.865350767365425*^9, 
   3.865350776574891*^9}, {3.8653508180138702`*^9, 3.865350818533597*^9}, {
   3.865351632405773*^9, 3.865351658834552*^9}, {3.8653517689428883`*^9, 
   3.865351818343164*^9}, {3.8654357502805367`*^9, 3.865435831398437*^9}, {
   3.865435984237856*^9, 3.8654360066128597`*^9}, {3.86543608253216*^9, 
   3.865436083292273*^9}, {3.865436118820344*^9, 3.865436151409917*^9}, {
   3.865468849728928*^9, 3.8654688531684837`*^9}, 3.865468925443646*^9, {
   3.865469671121582*^9, 3.86546977335218*^9}, {3.8654699052163973`*^9, 
   3.865469929688798*^9}, {3.865643516684636*^9, 3.865643653722386*^9}, {
   3.8656437272633333`*^9, 3.865643729589697*^9}, {3.86564381601982*^9, 
   3.865643863580852*^9}, {3.865646503729681*^9, 3.865646508526821*^9}, {
   3.866727106570796*^9, 3.866727108508498*^9}, {3.8667272014373293`*^9, 
   3.8667272170467052`*^9}, {3.866727363647483*^9, 3.866727366533828*^9}, {
   3.866728896058042*^9, 3.866728898485364*^9}, {3.866729209470235*^9, 
   3.8667292164288588`*^9}, {3.866730973176065*^9, 3.866730975824747*^9}, {
   3.866810289768015*^9, 3.866810294767694*^9}, {3.866812111968011*^9, 
   3.866812153966011*^9}, {3.866812637965616*^9, 3.8668126733039837`*^9}, {
   3.866814062094861*^9, 3.8668140642231903`*^9}, {3.866815096465145*^9, 
   3.866815103523384*^9}, {3.866815360090708*^9, 3.8668153625587673`*^9}, 
   3.866816095832706*^9, 3.866816147809741*^9, {3.866816414436214*^9, 
   3.8668164163031263`*^9}, {3.86681644669318*^9, 3.866816525680863*^9}, {
   3.866817474275814*^9, 3.866817492132806*^9}, {3.866817651532805*^9, 
   3.866817659330521*^9}, 3.866838269351281*^9, {3.866838603440456*^9, 
   3.866838604870344*^9}, {3.866838893788433*^9, 3.866838906907638*^9}, {
   3.866839643322075*^9, 3.866839646530057*^9}, {3.8668439064829407`*^9, 
   3.8668439389105797`*^9}, {3.866844043622143*^9, 3.8668440453786488`*^9}, {
   3.8668462907438087`*^9, 3.866846293112444*^9}, {3.868482399551818*^9, 
   3.868482404330986*^9}, {3.8684833564193983`*^9, 3.868483358159033*^9}, {
   3.8685460755288754`*^9, 3.86854607676686*^9}, {3.870452048770471*^9, 
   3.870452050330143*^9}, {3.870452125679102*^9, 3.870452174338282*^9}, 
   3.870452298345354*^9, {3.870452335474716*^9, 3.870452336024642*^9}, {
   3.870458173099992*^9, 3.870458209058899*^9}, {3.870909094096128*^9, 
   3.870909159777644*^9}, {3.8709092621218653`*^9, 3.8709092630312366`*^9}, {
   3.8709099838692837`*^9, 3.870910015209084*^9}, {3.87091063173766*^9, 
   3.870910634205814*^9}, {3.8709108649733667`*^9, 3.870910866871839*^9}, {
   3.8709109732705*^9, 3.870911007908288*^9}, {3.8709463770789633`*^9, 
   3.8709463797010612`*^9}, {3.870947404325959*^9, 3.870947405194859*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"4ba86ddc-0e5f-44ae-98ec-40b6da900085"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"T", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"t", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"s", "[", 
           RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"s", "[", 
           RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}]}]}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"]}]]}]}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"s", "[", 
           RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["s", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"s", "[", 
           RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["s", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["s", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["s", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"]}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"s", "[", 
           RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["s", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["s", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"]}]]}], 
         ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"s", "[", 
           RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["s", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"s", "[", 
           RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["s", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["s", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["s", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"]}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"s", "[", 
           RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["s", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["s", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"bhIdx", ",", "1", ",", "t"}], "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["s", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"bhIdx", ",", "2", ",", "t"}], "]"}], "2"]}]]}], 
         ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{"Z", "\[Rule]", "z"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8709093612287188`*^9, 3.870909583057197*^9, {3.870909972789873*^9, 
   3.870910016511373*^9}, 3.870910552321372*^9, 3.870910636286764*^9, 
   3.8709108993300247`*^9, 3.870910976469943*^9, 3.8709110109170732`*^9, 
   3.870911044785975*^9, 3.870911142399146*^9, 3.8709112557696037`*^9, 
   3.870911299568162*^9, 3.8709463860515223`*^9, 3.870947411340743*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"aa44fdec-46b7-4c57-96ba-f01de2103b6d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinate transformations codegen", "Section",
 CellChangeTimes->{{3.868484318022434*^9, 3.868484318712276*^9}, {
  3.8684882430264673`*^9, 3.868488249646393*^9}, {3.86863136330795*^9, 
  3.8686313666776953`*^9}},ExpressionUUID->"a94e94eb-0ea3-400a-8b3e-\
32ebab0fbf6a"],

Cell[CellGroupData[{

Cell["Genereting function", "Subsection",
 CellChangeTimes->{{3.868488255176363*^9, 
  3.868488258736332*^9}},ExpressionUUID->"3de864e7-e5ff-45d1-88cf-\
5956f307e41d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "genCoordTransf", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genCoordTransf", "[", 
    RowBox[{"ct_", ",", "strname_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"str", ",", "name", ",", "cse", ",", "expr", ",", "var"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{
       "\"\<#include \\\"SKS.hpp\\\"\n\nauto grlensing::SKS::\>\"", "<>", 
        "strname", "<>", 
        "\"\<(unsigned bhIdx, double t, double x, double y, double z) const \
noexcept -> double {\n\n  using std::sqrt;\n  using std::pow;\n\n\>\""}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"cse", "=", 
       RowBox[{"hoistCommonSubexpressions", "[", "ct", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"expr", "=", 
       RowBox[{
       "cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "=", 
          RowBox[{"List", "@@", 
           RowBox[{"cse", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"str", "=", 
          RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  return \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"expr", ",", "CForm"}], "]"}], "<>", "\"\<;\\n}\>\""}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "trajectoryRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "trajectoryDerivRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"name", "=", 
       RowBox[{"strname", "<>", "\"\<.cpp\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"name", ",", "str", ",", "\"\<Text\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{"\"\<clang-format -i \>\"", "<>", "name"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{
       "\"\<mv \>\"", "<>", "name", "<>", 
        "\"\< ../../plugins/metrics/SKS/source\>\""}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868485487506357*^9, 3.868485550601577*^9}, {
   3.868485586682437*^9, 3.868485742458243*^9}, {3.868485786287992*^9, 
   3.8684858184171*^9}, {3.8684865533323402`*^9, 3.868486558330749*^9}, {
   3.868486657270918*^9, 3.868486659599221*^9}, {3.868486816737585*^9, 
   3.868486820465933*^9}, {3.868486864946609*^9, 3.868487022533046*^9}, {
   3.8684871660206413`*^9, 3.8684871731599617`*^9}, 3.86848735602656*^9, {
   3.868487504524808*^9, 3.868487536872937*^9}, {3.8684875679225883`*^9, 
   3.868487571291821*^9}, {3.8684876490015697`*^9, 3.868487659130623*^9}, {
   3.868487689220093*^9, 3.868487815197607*^9}, {3.868487883016389*^9, 
   3.868487885775139*^9}, {3.868487932365218*^9, 3.8684879349141617`*^9}, {
   3.868488538482785*^9, 3.8684886254810534`*^9}, {3.868488699310775*^9, 
   3.868488714290896*^9}, {3.868488780050754*^9, 3.8684887848393297`*^9}, {
   3.868546471341316*^9, 3.868546478301269*^9}, {3.8685660990474777`*^9, 
   3.86856610773669*^9}, {3.86856621220612*^9, 3.8685662144978456`*^9}, {
   3.868631404718335*^9, 3.868631414541198*^9}, {3.868631531936882*^9, 
   3.868631741732997*^9}, {3.8686319694786367`*^9, 3.868631982217166*^9}, {
   3.87045238883331*^9, 3.87045252740941*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"c50f8038-9720-426e-9a0b-bb7fd791994f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generation calls", "Subsection",
 CellChangeTimes->{{3.868488264276366*^9, 
  3.868488268196279*^9}},ExpressionUUID->"391b9541-a0ac-4e2d-aea5-\
ff9baea81be9"],

Cell[BoxData[{
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"T", "//.", "sol"}], ",", "\"\<T\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"X", "//.", "sol"}], ",", "\"\<X\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"Y", "//.", "sol"}], ",", "\"\<Y\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"Z", "//.", "sol"}], ",", "\"\<Z\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.8686317095423822`*^9, 3.868631713372295*^9}, {
  3.868631757631897*^9, 3.8686317593011217`*^9}, {3.868631941518652*^9, 
  3.868631952197554*^9}, {3.870911182210599*^9, 3.870911191113303*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"7c2f0bad-e804-47e6-b71d-cccaa4e70058"],

Cell[BoxData[{
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"T", "//.", "sol"}], ",", "t"}], "]"}], "]"}], ",", 
   "\"\<dT_dt\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"T", "//.", "sol"}], ",", "x"}], "]"}], "]"}], ",", 
   "\"\<dT_dx\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"T", "//.", "sol"}], ",", "y"}], "]"}], "]"}], ",", 
   "\"\<dT_dy\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"T", "//.", "sol"}], ",", "z"}], "]"}], "]"}], ",", 
   "\"\<dT_dz\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.8704571951456633`*^9, 3.870457248663968*^9}, {
  3.8709112024575*^9, 3.870911212756586*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"7353dd4f-5c21-473a-a35b-d53851de2c32"],

Cell[BoxData[{
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"X", "//.", "sol"}], ",", "t"}], "]"}], "]"}], ",", 
   "\"\<dX_dt\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"X", "//.", "sol"}], ",", "x"}], "]"}], "]"}], ",", 
   "\"\<dX_dx\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"X", "//.", "sol"}], ",", "y"}], "]"}], "]"}], ",", 
   "\"\<dX_dy\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"X", "//.", "sol"}], ",", "z"}], "]"}], "]"}], ",", 
   "\"\<dX_dz\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.8704571951456633`*^9, 3.870457248663968*^9}, {
  3.8709112024575*^9, 3.870911224883443*^9}, {3.8709112778727303`*^9, 
  3.87091128009229*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"775f1cf0-3922-495a-90b6-6e64474f088d"],

Cell[BoxData[{
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Y", "//.", "sol"}], ",", "t"}], "]"}], "]"}], ",", 
   "\"\<dY_dt\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Y", "//.", "sol"}], ",", "x"}], "]"}], "]"}], ",", 
   "\"\<dY_dx\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Y", "//.", "sol"}], ",", "y"}], "]"}], "]"}], ",", 
   "\"\<dY_dy\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Y", "//.", "sol"}], ",", "z"}], "]"}], "]"}], ",", 
   "\"\<dY_dz\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.8704571951456633`*^9, 3.870457248663968*^9}, {
  3.8709112024575*^9, 3.870911231383562*^9}, {3.870911283572754*^9, 
  3.870911285562345*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"e97241a2-0bcf-4a48-942c-7ff956e68c08"],

Cell[BoxData[{
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z", "//.", "sol"}], ",", "t"}], "]"}], "]"}], ",", 
   "\"\<dZ_dt\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z", "//.", "sol"}], ",", "x"}], "]"}], "]"}], ",", 
   "\"\<dZ_dx\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z", "//.", "sol"}], ",", "y"}], "]"}], "]"}], ",", 
   "\"\<dZ_dy\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"genCoordTransf", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z", "//.", "sol"}], ",", "z"}], "]"}], "]"}], ",", 
   "\"\<dZ_dz\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.8704571951456633`*^9, 3.870457248663968*^9}, {
  3.8709112024575*^9, 3.8709112370933228`*^9}, {3.870911287822775*^9, 
  3.870911290582308*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"7be3d94b-d3bc-4880-958e-068d6fc13679"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory codegen", "Title",
 CellChangeTimes->{{3.868631261679698*^9, 3.868631266099465*^9}, {
  3.8686323356377153`*^9, 
  3.868632337007392*^9}},ExpressionUUID->"05b4336b-849d-4472-ad96-\
bf9f8b1405ea"],

Cell[CellGroupData[{

Cell["CSE and codegen utilities", "Section",
 CellChangeTimes->{{3.868439204911605*^9, 
  3.868439214061768*^9}},ExpressionUUID->"288ea30b-31db-4167-afe9-\
3f84a5b1280f"],

Cell[CellGroupData[{

Cell["CSE", "Subsection",
 CellChangeTimes->{{3.868371468625771*^9, 
  3.868371468976837*^9}},ExpressionUUID->"6fdb90ef-7289-4087-9288-\
b0a06593738d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], "/", 
       "4202845"}], "/", "mathematica"}], "-", "using", "-", "simplify", "-", 
     "to", "-", "do", "-", "common", "-", "sub", "-", "expression", "-", 
     "elimination", "-", "and", "-", "reductio"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"stoney", ".", "sb", ".", "org"}], "/", "wordpress"}], "/", 
      "wp"}], "-", 
     RowBox[{
      RowBox[{"content", "/", "cvt2c"}], "/"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"<<", "cse.m"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"b204f3c9-7645-4f47-acba-18ac09552ed7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Capitalization", "Subsection",
 CellChangeTimes->{{3.868439493907201*^9, 
  3.868439496307272*^9}},ExpressionUUID->"ed29b3ba-66b2-4edd-b146-\
6a20c4b2b9cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "capitalizationRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"capitalizationRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868316105323255*^9, 3.868316157929685*^9}, {
   3.868316230109397*^9, 3.868316306948285*^9}, {3.86831634177719*^9, 
   3.86831635056705*^9}, {3.868316425275738*^9, 3.868316537946056*^9}, {
   3.868316591092558*^9, 3.868316597142627*^9}, {3.8683166621718187`*^9, 
   3.8683166908708763`*^9}, {3.868371896499003*^9, 3.8683719011111813`*^9}, {
   3.868375787792369*^9, 3.86837583159341*^9}, {3.868381925961285*^9, 
   3.868381934913391*^9}, {3.8683968959356737`*^9, 3.8683970125234003`*^9}, {
   3.8684004316580677`*^9, 3.868400458276379*^9}, {3.868400961138571*^9, 
   3.868400962018216*^9}, {3.8684011791176558`*^9, 3.868401187714568*^9}, {
   3.868401291792986*^9, 3.868401466970656*^9}, {3.868401504491877*^9, 
   3.8684015112202682`*^9}, 3.868439343095846*^9, {3.868632537713724*^9, 
   3.8686325485131283`*^9}, 3.8704574383626957`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"ed701c46-7d89-4cfb-ab0d-73ca4bd5b7be"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory", "Section",
 CellChangeTimes->{{3.861117175300764*^9, 3.861117176651064*^9}, {
  3.868312539238172*^9, 3.868312540807959*^9}, {3.868632350696508*^9, 
  3.8686323512665653`*^9}},ExpressionUUID->"6d505258-fcd1-46c2-8e81-\
9907bd72073d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"\[CapitalOmega]", ",", "sx", ",", "sy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "=", 
   SqrtBox[
    FractionBox[
     RowBox[{"M1", "+", "M2"}], 
     SuperscriptBox["b", "3"]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sx", "[", 
    RowBox[{"bhIdx_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"bhIdx", "+", "1"}]], 
    FractionBox["b", "2"], 
    RowBox[{"Cos", "[", 
     RowBox[{"\[CapitalOmega]", "*", "t"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sy", "[", 
    RowBox[{"bhIdx_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"bhIdx", "+", "1"}]], 
    FractionBox["b", "2"], 
    RowBox[{"Sin", "[", 
     RowBox[{"\[CapitalOmega]", "*", "t"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.865524415966897*^9, 3.86552450094634*^9}, {
   3.865524535705659*^9, 3.865524577444357*^9}, {3.8655246263548803`*^9, 
   3.8655247221620207`*^9}, {3.8655247587139597`*^9, 3.865524763002427*^9}, {
   3.865524836472784*^9, 3.865524854740614*^9}, {3.8655257699381237`*^9, 
   3.865525797397901*^9}, {3.865525836069531*^9, 3.865525920534947*^9}, {
   3.8655259535456867`*^9, 3.8655260364731073`*^9}, {3.8655261499617853`*^9, 
   3.8655262074301443`*^9}, {3.865526268380827*^9, 3.865526340467456*^9}, {
   3.8656428148073187`*^9, 3.865643058742819*^9}, {3.866726555357901*^9, 
   3.8667266368467607`*^9}, {3.86673043501088*^9, 3.866730505437317*^9}, {
   3.8667305850387707`*^9, 3.866730707203352*^9}, {3.86680872129394*^9, 
   3.866808748958291*^9}, {3.866810261959326*^9, 3.8668102701881647`*^9}, {
   3.866812240482986*^9, 3.866812249263751*^9}, 3.866812591336658*^9, {
   3.866817670121509*^9, 3.8668177369491367`*^9}, {3.866820373073388*^9, 
   3.866820388151572*^9}, 3.866820479590761*^9, {3.8668367698413067`*^9, 
   3.866836824467847*^9}, {3.866838253643696*^9, 3.866838258861363*^9}, {
   3.8668433938138447`*^9, 3.86684343260563*^9}, {3.866843566561852*^9, 
   3.8668436077288733`*^9}, {3.866843639518705*^9, 3.866843640959424*^9}, {
   3.8668461263282957`*^9, 3.866846131606632*^9}, {3.8681135914439793`*^9, 
   3.8681136278999453`*^9}, {3.868128508421637*^9, 3.868128528141382*^9}, {
   3.8683123424645777`*^9, 3.868312365057095*^9}, {3.8683123985045147`*^9, 
   3.868312403733046*^9}, {3.868312519773333*^9, 3.8683125321105328`*^9}, {
   3.868482449212385*^9, 3.868482450281295*^9}, {3.868484256585382*^9, 
   3.8684842574242764`*^9}, {3.868632354987523*^9, 3.868632423285839*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"24bfb616-b6f9-45e2-a134-fa8bf0369bf8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinate transformations codegen", "Section",
 CellChangeTimes->{{3.868484318022434*^9, 3.868484318712276*^9}, {
  3.8684882430264673`*^9, 3.868488249646393*^9}, {3.86863136330795*^9, 
  3.8686313666776953`*^9}},ExpressionUUID->"6f16d359-969c-41f9-a795-\
5dd3c0c2a36c"],

Cell[CellGroupData[{

Cell["Genereting function", "Subsection",
 CellChangeTimes->{{3.868488255176363*^9, 
  3.868488258736332*^9}},ExpressionUUID->"1a638307-d4b5-403c-8ca0-\
e7147fa89e64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "genTrajectory", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genTrajectory", "[", 
    RowBox[{"traj_", ",", "strname_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"str", ",", "name", ",", "cse", ",", "expr"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{
       "\"\<#include \\\"SKS.hpp\\\"\n\nauto grlensing::SKS::\>\"", "<>", 
        "strname", "<>", 
        "\"\<(unsigned bhIdx, double t) const noexcept -> double {\n\n  using \
std::sin;\n  using std::pow;\n  using std::sqrt;\n  using std::cos;\n\n\
\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cse", "=", 
       RowBox[{"hoistCommonSubexpressions", "[", "traj", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"expr", "=", 
       RowBox[{
       "cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "=", 
          RowBox[{"List", "@@", 
           RowBox[{"cse", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"str", "=", 
          RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  return \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"expr", ",", "CForm"}], "]"}], "<>", "\"\<;\\n}\>\""}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"name", "=", 
       RowBox[{"strname", "<>", "\"\<.cpp\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"name", ",", "str", ",", "\"\<Text\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{"\"\<clang-format -i \>\"", "<>", "name"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{
       "\"\<mv \>\"", "<>", "name", "<>", 
        "\"\< ../../plugins/metrics/SKS/source\>\""}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868485487506357*^9, 3.868485550601577*^9}, {
   3.868485586682437*^9, 3.868485742458243*^9}, {3.868485786287992*^9, 
   3.8684858184171*^9}, {3.8684865533323402`*^9, 3.868486558330749*^9}, {
   3.868486657270918*^9, 3.868486659599221*^9}, {3.868486816737585*^9, 
   3.868486820465933*^9}, {3.868486864946609*^9, 3.868487022533046*^9}, {
   3.8684871660206413`*^9, 3.8684871731599617`*^9}, 3.86848735602656*^9, {
   3.868487504524808*^9, 3.868487536872937*^9}, {3.8684875679225883`*^9, 
   3.868487571291821*^9}, {3.8684876490015697`*^9, 3.868487659130623*^9}, {
   3.868487689220093*^9, 3.868487815197607*^9}, {3.868487883016389*^9, 
   3.868487885775139*^9}, {3.868487932365218*^9, 3.8684879349141617`*^9}, {
   3.868488538482785*^9, 3.8684886254810534`*^9}, {3.868488699310775*^9, 
   3.868488714290896*^9}, {3.868488780050754*^9, 3.8684887848393297`*^9}, {
   3.868546471341316*^9, 3.868546478301269*^9}, {3.8685660990474777`*^9, 
   3.86856610773669*^9}, {3.86856621220612*^9, 3.8685662144978456`*^9}, {
   3.868631404718335*^9, 3.868631414541198*^9}, {3.868631531936882*^9, 
   3.868631741732997*^9}, {3.8686319694786367`*^9, 3.868631982217166*^9}, {
   3.868632448137203*^9, 3.8686324886446657`*^9}, {3.86863267654108*^9, 
   3.868632684570106*^9}, {3.870457747947225*^9, 3.870457763847155*^9}, {
   3.8704578257766333`*^9, 3.870457827736166*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"0244c3a6-0759-4697-8848-50398ef8d1aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generation calls", "Subsection",
 CellChangeTimes->{{3.868488264276366*^9, 
  3.868488268196279*^9}},ExpressionUUID->"ea4f81cf-fd4d-4208-9015-\
cc3120bf542b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genTrajectory", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"sx", "[", 
      RowBox[{"bhIdx", ",", "t"}], "]"}], "]"}], ",", "\"\<sx\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genTrajectory", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"sy", "[", 
      RowBox[{"bhIdx", ",", "t"}], "]"}], "]"}], ",", "\"\<sy\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8686317095423822`*^9, 3.868631713372295*^9}, {
  3.868631757631897*^9, 3.8686317593011217`*^9}, {3.868631941518652*^9, 
  3.868631952197554*^9}, {3.868632499928937*^9, 3.868632509732833*^9}, {
  3.8686325928924093`*^9, 3.868632613160556*^9}, {3.870457886194461*^9, 
  3.870457920703326*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"09a6876b-24ea-46af-b33c-af577e1c7856"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genTrajectory", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"sx", "[", 
        RowBox[{"bhIdx", ",", "t"}], "]"}], ",", "t"}], "]"}], "]"}], ",", 
    "\"\<dsx_dt\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genTrajectory", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"sy", "[", 
        RowBox[{"bhIdx", ",", "t"}], "]"}], ",", "t"}], "]"}], "]"}], ",", 
    "\"\<dsy_dt\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868632601401589*^9, 3.868632626000415*^9}, {
  3.870457895767105*^9, 3.87045791040341*^9}, {3.8704579650132523`*^9, 
  3.8704579724925337`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"885247e7-84a2-4d12-80f0-b0dec57eb4f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genTrajectory", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"sx", "[", 
        RowBox[{"bhIdx", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
    "\"\<d2sx_dt2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genTrajectory", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"sy", "[", 
        RowBox[{"bhIdx", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
    "\"\<d2sy_dt2\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.868632693109661*^9, 3.8686327024395313`*^9}, {
  3.870457901077445*^9, 3.870457908293434*^9}, {3.870457940665621*^9, 
  3.870457953763575*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"5e220a8a-9254-4d70-98d7-3006387616de"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kerr metric components", "Title",
 CellChangeTimes->{{3.868631261679698*^9, 3.868631266099465*^9}, {
  3.8686323356377153`*^9, 3.868632337007392*^9}, {3.870960619044257*^9, 
  3.870960626163913*^9}},ExpressionUUID->"2a0d039c-ffec-40dc-947a-\
a2c41707f5c1"],

Cell[CellGroupData[{

Cell["CSE and codegen utilities", "Section",
 CellChangeTimes->{{3.868439204911605*^9, 
  3.868439214061768*^9}},ExpressionUUID->"b2202387-2253-41db-a919-\
1ecd34bb2508"],

Cell[CellGroupData[{

Cell["CSE", "Subsection",
 CellChangeTimes->{{3.868371468625771*^9, 
  3.868371468976837*^9}},ExpressionUUID->"a089c63b-8ea4-49db-8c18-\
b647a5c4928d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], "/", 
       "4202845"}], "/", "mathematica"}], "-", "using", "-", "simplify", "-", 
     "to", "-", "do", "-", "common", "-", "sub", "-", "expression", "-", 
     "elimination", "-", "and", "-", "reductio"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"stoney", ".", "sb", ".", "org"}], "/", "wordpress"}], "/", 
      "wp"}], "-", 
     RowBox[{
      RowBox[{"content", "/", "cvt2c"}], "/"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"<<", "cse.m"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"5f67d75b-53f7-417f-a435-ca173754c077"]
}, Closed]],

Cell[CellGroupData[{

Cell["Capitalization", "Subsection",
 CellChangeTimes->{{3.868439493907201*^9, 
  3.868439496307272*^9}},ExpressionUUID->"3770cc53-072e-49b2-b44f-\
e6fc12501006"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "capitalizationRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"capitalizationRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868316105323255*^9, 3.868316157929685*^9}, {
   3.868316230109397*^9, 3.868316306948285*^9}, {3.86831634177719*^9, 
   3.86831635056705*^9}, {3.868316425275738*^9, 3.868316537946056*^9}, {
   3.868316591092558*^9, 3.868316597142627*^9}, {3.8683166621718187`*^9, 
   3.8683166908708763`*^9}, {3.868371896499003*^9, 3.8683719011111813`*^9}, {
   3.868375787792369*^9, 3.86837583159341*^9}, {3.868381925961285*^9, 
   3.868381934913391*^9}, {3.8683968959356737`*^9, 3.8683970125234003`*^9}, {
   3.8684004316580677`*^9, 3.868400458276379*^9}, {3.868400961138571*^9, 
   3.868400962018216*^9}, {3.8684011791176558`*^9, 3.868401187714568*^9}, {
   3.868401291792986*^9, 3.868401466970656*^9}, {3.868401504491877*^9, 
   3.8684015112202682`*^9}, 3.868439343095846*^9, {3.868632537713724*^9, 
   3.8686325485131283`*^9}, 3.8704574383626957`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"265b581f-9a57-45e2-a844-8a2eb95adfe2"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kerr metric functions", "Section",
 CellChangeTimes->{{3.861117175300764*^9, 3.861117176651064*^9}, {
  3.868312539238172*^9, 3.868312540807959*^9}, {3.868632350696508*^9, 
  3.8686323512665653`*^9}, {3.8709606453529663`*^9, 
  3.870960649492199*^9}},ExpressionUUID->"e90ec935-fe99-4cc8-b717-\
5585d02132aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\[Rho]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "=", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["X", "2"], "+", 
      SuperscriptBox["Y", "2"], "+", 
      SuperscriptBox["Z", "2"]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "r", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{"FullSimplify", "[", 
     SqrtBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "-", 
          SuperscriptBox["a", "2"]}], ")"}]}], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Rho]", "2"], "-", 
             SuperscriptBox["a", "2"]}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], 
          SuperscriptBox["Z", "2"]}]}]]}]], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "l1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l1", "=", 
    RowBox[{"FullSimplify", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"r", "*", "X"}], "+", 
       RowBox[{"a", "*", "Y"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       SuperscriptBox["a", "2"]}]], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "l2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l2", "=", 
    RowBox[{"FullSimplify", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"r", "*", "Y"}], "-", 
       RowBox[{"a", "*", "X"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       SuperscriptBox["a", "2"]}]], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "l3", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l3", "=", 
    RowBox[{"FullSimplify", "[", 
     FractionBox["Z", "r"], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "H", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"FullSimplify", "[", 
    FractionBox[
     RowBox[{"2", "M", "*", 
      SuperscriptBox["r", "3"]}], 
     RowBox[{
      SuperscriptBox["r", "4"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       SuperscriptBox["Z", "2"]}]}]], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.865524415966897*^9, 3.86552450094634*^9}, {
   3.865524535705659*^9, 3.865524577444357*^9}, {3.8655246263548803`*^9, 
   3.8655247221620207`*^9}, {3.8655247587139597`*^9, 3.865524763002427*^9}, {
   3.865524836472784*^9, 3.865524854740614*^9}, {3.8655257699381237`*^9, 
   3.865525797397901*^9}, {3.865525836069531*^9, 3.865525920534947*^9}, {
   3.8655259535456867`*^9, 3.8655260364731073`*^9}, {3.8655261499617853`*^9, 
   3.8655262074301443`*^9}, {3.865526268380827*^9, 3.865526340467456*^9}, {
   3.8656428148073187`*^9, 3.865643058742819*^9}, {3.866726555357901*^9, 
   3.8667266368467607`*^9}, {3.86673043501088*^9, 3.866730505437317*^9}, {
   3.8667305850387707`*^9, 3.866730707203352*^9}, {3.86680872129394*^9, 
   3.866808748958291*^9}, {3.866810261959326*^9, 3.8668102701881647`*^9}, {
   3.866812240482986*^9, 3.866812249263751*^9}, 3.866812591336658*^9, {
   3.866817670121509*^9, 3.8668177369491367`*^9}, {3.866820373073388*^9, 
   3.866820388151572*^9}, 3.866820479590761*^9, {3.8668367698413067`*^9, 
   3.866836824467847*^9}, {3.866838253643696*^9, 3.866838258861363*^9}, {
   3.8668433938138447`*^9, 3.86684343260563*^9}, {3.866843566561852*^9, 
   3.8668436077288733`*^9}, {3.866843639518705*^9, 3.866843640959424*^9}, {
   3.8668461263282957`*^9, 3.866846131606632*^9}, {3.8681135914439793`*^9, 
   3.8681136278999453`*^9}, {3.868128508421637*^9, 3.868128528141382*^9}, {
   3.8683123424645777`*^9, 3.868312365057095*^9}, {3.8683123985045147`*^9, 
   3.868312403733046*^9}, {3.868312519773333*^9, 3.8683125321105328`*^9}, {
   3.868482449212385*^9, 3.868482450281295*^9}, {3.868484256585382*^9, 
   3.8684842574242764`*^9}, {3.868632354987523*^9, 3.868632423285839*^9}, {
   3.870960683562791*^9, 3.8709607030805473`*^9}, {3.87096075904825*^9, 
   3.8709607678281*^9}, {3.870964127723063*^9, 3.870964283059737*^9}, {
   3.870965995725216*^9, 3.870966009925379*^9}, {3.870966141551642*^9, 
   3.870966143741954*^9}, 3.8709676967482653`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"577fd845-82e9-4819-ac9b-6f27da9396a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinate transformations codegen", "Section",
 CellChangeTimes->{{3.868484318022434*^9, 3.868484318712276*^9}, {
  3.8684882430264673`*^9, 3.868488249646393*^9}, {3.86863136330795*^9, 
  3.8686313666776953`*^9}},ExpressionUUID->"8143fbf6-b681-4775-bf68-\
f72dd9f143c0"],

Cell[CellGroupData[{

Cell["Genereting function", "Subsection",
 CellChangeTimes->{{3.868488255176363*^9, 
  3.868488258736332*^9}},ExpressionUUID->"75b98004-29f4-457d-9ed7-\
a0d1a49870ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "genKerrFunc", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genKerrFunc", "[", 
    RowBox[{"funcName_", ",", "params_", ",", "expression_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"str", ",", "name", ",", "cse", ",", "expr", ",", "var"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{
       "\"\<inline auto \>\"", "<>", "funcName", "<>", "\"\<(\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", 
          RowBox[{
          "params", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "<>", "\"\<, \>\""}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "params", "]"}], "-", "1"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", 
        RowBox[{"params", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "<>", 
        "\"\<) {\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cse", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"hoistCommonSubexpressions", "[", "expression", "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"expr", "=", 
       RowBox[{
       "cse", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "=", 
          RowBox[{"List", "@@", 
           RowBox[{"cse", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"str", "=", 
          RowBox[{"str", "<>", "\"\<  const double \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<{\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
             "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "CForm"}], "]"}], "<>", "\"\<};\\n\>\""}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ClearAll", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "cse", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"str", "<>", "\"\<\\n  return \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"expr", ",", "CForm"}], "]"}], "<>", "\"\<;\\n}\>\""}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", "capitalizationRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "str", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.868485487506357*^9, 3.868485550601577*^9}, {
   3.868485586682437*^9, 3.868485742458243*^9}, {3.868485786287992*^9, 
   3.8684858184171*^9}, {3.8684865533323402`*^9, 3.868486558330749*^9}, {
   3.868486657270918*^9, 3.868486659599221*^9}, {3.868486816737585*^9, 
   3.868486820465933*^9}, {3.868486864946609*^9, 3.868487022533046*^9}, {
   3.8684871660206413`*^9, 3.8684871731599617`*^9}, 3.86848735602656*^9, {
   3.868487504524808*^9, 3.868487536872937*^9}, {3.8684875679225883`*^9, 
   3.868487571291821*^9}, {3.8684876490015697`*^9, 3.868487659130623*^9}, {
   3.868487689220093*^9, 3.868487815197607*^9}, {3.868487883016389*^9, 
   3.868487885775139*^9}, {3.868487932365218*^9, 3.8684879349141617`*^9}, {
   3.868488538482785*^9, 3.8684886254810534`*^9}, {3.868488699310775*^9, 
   3.868488714290896*^9}, {3.868488780050754*^9, 3.8684887848393297`*^9}, {
   3.868546471341316*^9, 3.868546478301269*^9}, {3.8685660990474777`*^9, 
   3.86856610773669*^9}, {3.86856621220612*^9, 3.8685662144978456`*^9}, {
   3.868631404718335*^9, 3.868631414541198*^9}, {3.868631531936882*^9, 
   3.868631741732997*^9}, {3.8686319694786367`*^9, 3.868631982217166*^9}, {
   3.868632448137203*^9, 3.8686324886446657`*^9}, {3.86863267654108*^9, 
   3.868632684570106*^9}, {3.870457747947225*^9, 3.870457763847155*^9}, {
   3.8704578257766333`*^9, 3.870457827736166*^9}, {3.87096463572209*^9, 
   3.870964718627852*^9}, {3.870964851584324*^9, 3.870964921122938*^9}, {
   3.870964960772187*^9, 3.870965002851016*^9}, {3.870965058921351*^9, 
   3.870965065849926*^9}, {3.870965137329213*^9, 3.870965174237562*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"b567264b-b264-458d-bed9-c9452022ce2b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generation calls", "Subsection",
 CellChangeTimes->{{3.868488264276366*^9, 
  3.868488268196279*^9}},ExpressionUUID->"bb9b8247-974a-4a43-81ee-\
23e68325295d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "headerStr", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "headerStr", "=", 
    "\"\<#ifndef GRLENSING_SKS_AUX_FUNCTIONS\n#define \
GRLENSING_SKS_AUX_FUNCTIONS\n\n#include \
\\\"../../../../include/tensor_types.hpp\\\"\n\n#include <cmath>\n#include \
<cstddef>\n\nnamespace sks_aux {\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<H_KS\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double M\>\"", ",", "\"\<double a\>\"", ",", "\"\<double X\>\"", 
        ",", "\"\<double Y\>\"", ",", "\"\<double Z\>\""}], "}"}], ",", "H"}],
      "]"}], "<>", "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<l1_KS\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
        ",", "\"\<double Z\>\""}], "}"}], ",", "l1"}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<l2_KS\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
        ",", "\"\<double Z\>\""}], "}"}], ",", "l2"}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headerStr", "=", 
    RowBox[{"headerStr", "<>", 
     RowBox[{"genKerrFunc", "[", 
      RowBox[{"\"\<l3_KS\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
         ",", "\"\<double Z\>\""}], "}"}], ",", "l3"}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dH_KS_dX\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double M\>\"", ",", "\"\<double a\>\"", ",", "\"\<double X\>\"", 
        ",", "\"\<double Y\>\"", ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"H", ",", "X"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dl1_KS_dX\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
        ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"l1", ",", "X"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dl2_KS_dX\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
        ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"l2", ",", "X"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headerStr", "=", 
    RowBox[{"headerStr", "<>", 
     RowBox[{"genKerrFunc", "[", 
      RowBox[{"\"\<dl3_KS_dX\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
         ",", "\"\<double Z\>\""}], "}"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"l3", ",", "X"}], "]"}], "]"}]}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dH_KS_dY\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double M\>\"", ",", "\"\<double a\>\"", ",", "\"\<double X\>\"", 
        ",", "\"\<double Y\>\"", ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"H", ",", "Y"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dl1_KS_dY\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
        ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"l1", ",", "Y"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dl2_KS_dY\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
        ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"l2", ",", "Y"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headerStr", "=", 
    RowBox[{"headerStr", "<>", 
     RowBox[{"genKerrFunc", "[", 
      RowBox[{"\"\<dl3_KS_dY\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
         ",", "\"\<double Z\>\""}], "}"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"l3", ",", "Y"}], "]"}], "]"}]}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dH_KS_dZ\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double M\>\"", ",", "\"\<double a\>\"", ",", "\"\<double X\>\"", 
        ",", "\"\<double Y\>\"", ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"H", ",", "Z"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dl1_KS_dZ\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
        ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"l1", ",", "Z"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerStr", "=", 
   RowBox[{"headerStr", "<>", 
    RowBox[{"genKerrFunc", "[", 
     RowBox[{"\"\<dl2_KS_dZ\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
        ",", "\"\<double Z\>\""}], "}"}], ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{"l2", ",", "Z"}], "]"}], "]"}]}], "]"}], "<>", 
    "\"\<\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headerStr", "=", 
    RowBox[{"headerStr", "<>", 
     RowBox[{"genKerrFunc", "[", 
      RowBox[{"\"\<dl3_KS_dZ\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<double a\>\"", ",", "\"\<double X\>\"", ",", "\"\<double Y\>\"", 
         ",", "\"\<double Z\>\""}], "}"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"l3", ",", "Z"}], "]"}], "]"}]}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headerStr", "=", 
    RowBox[{
    "headerStr", "<>", 
     "\"\<} // sks_aux\\n\\n#endif // GRLENSING_SKS_AUX_FUNCTIONS\>\""}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<aux_functions.hpp\>\"", ",", "headerStr", ",", "\"\<Text\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<clang-format -i aux_functions.hpp\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Run", "[", 
    "\"\<mv aux_functions.hpp ../../plugins/metrics/SKS/include\>\"", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "headerStr", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.870965716601872*^9, 3.870965778370388*^9}, {
  3.870966497232647*^9, 3.87096653947085*^9}, {3.8709666106226273`*^9, 
  3.8709666190195436`*^9}, {3.8709667047490883`*^9, 3.870966763251624*^9}, {
  3.87096679686491*^9, 3.870966837973536*^9}, {3.870966876546258*^9, 
  3.870966887142126*^9}, {3.870966964560897*^9, 3.8709669929831667`*^9}, {
  3.870967024400745*^9, 3.870967034779209*^9}, {3.870967223884118*^9, 
  3.870967243813162*^9}, {3.870967274744817*^9, 3.8709673492642527`*^9}, {
  3.870967485040201*^9, 3.870967492617202*^9}, {3.870968025720984*^9, 
  3.870968069751639*^9}, {3.872122275712449*^9, 3.872122341958897*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"f2e5c8d5-ad19-4410-9928-ad61f5faa523"]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1502.608695652174, 788.0869565217392},
WindowMargins->{{0, Automatic}, {Automatic, 22.945054945054945`}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
ShowSelection->True,
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"e9fbdf28-66ce-4359-b2d9-587b79f04be9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 268, 4, 61, "Title",ExpressionUUID->"8ff0d09f-00f0-43c0-a1d1-c2aaec281461"],
Cell[CellGroupData[{
Cell[715, 23, 371, 6, 74, "Section",ExpressionUUID->"1c41b9a9-7400-42a4-b2ac-9cebb1a7d2a9"],
Cell[1089, 31, 6866, 126, 247, "Input",ExpressionUUID->"a31afc9d-f6d1-4e3e-a952-28d3bc48d72f"]
}, Closed]],
Cell[CellGroupData[{
Cell[7992, 162, 159, 3, 44, "Section",ExpressionUUID->"0f6f3127-1aac-4633-bd66-94cd73509965"],
Cell[8154, 167, 6917, 199, 624, "Input",ExpressionUUID->"ecc62a60-379d-472e-ab04-cfac23a0d0a0"]
}, Closed]],
Cell[CellGroupData[{
Cell[15108, 371, 170, 3, 44, "Section",ExpressionUUID->"553a9113-a371-48fc-bc00-d2595122b733"],
Cell[CellGroupData[{
Cell[15303, 378, 151, 3, 35, "Subsection",ExpressionUUID->"d1434d19-8af1-4e2c-a878-97c7290b23e8"],
Cell[15457, 383, 880, 26, 84, "Input",ExpressionUUID->"99eec412-90a9-4795-ba53-ce4fd1537707"]
}, Closed]],
Cell[CellGroupData[{
Cell[16374, 414, 162, 3, 27, "Subsection",ExpressionUUID->"13cf0238-6bd6-4961-b5a9-4f6156906d24"],
Cell[16539, 419, 1289, 23, 124, "Input",ExpressionUUID->"7a83c6f5-cabd-4ab3-b66d-aa2d112aefa5"]
}, Closed]],
Cell[CellGroupData[{
Cell[17865, 447, 153, 3, 27, "Subsection",ExpressionUUID->"42e0f279-8c41-474b-a19d-b671962febe5"],
Cell[18021, 452, 1670, 40, 288, "Input",ExpressionUUID->"bc1af3bc-7087-4e98-b015-b9ba92b5c999"]
}, Closed]],
Cell[CellGroupData[{
Cell[19728, 497, 168, 3, 27, "Subsection",ExpressionUUID->"f89d3173-2b3d-408b-bec8-8641803da54d"],
Cell[19899, 502, 7093, 141, 1090, "Input",ExpressionUUID->"e3b8a2a7-3fc4-43a7-a060-f11fd546fe38"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[27041, 649, 154, 3, 44, "Section",ExpressionUUID->"1c5ffc1e-6978-46ab-8811-a70ae4ffe0a4"],
Cell[27198, 654, 4156, 99, 782, "Input",ExpressionUUID->"32e1038d-9013-4759-948a-18da960b23be"]
}, Closed]],
Cell[CellGroupData[{
Cell[31391, 758, 211, 4, 44, "Section",ExpressionUUID->"1971a534-376a-4e97-9998-a86e203b91cc"],
Cell[31605, 764, 5219, 126, 843, "Input",ExpressionUUID->"5611056a-14e3-4ecd-8366-c7e4f84f7f64"]
}, Closed]],
Cell[CellGroupData[{
Cell[36861, 895, 255, 4, 44, "Section",ExpressionUUID->"86329816-ea40-40fb-9378-0274b9195b2f"],
Cell[37119, 901, 5665, 131, 905, "Input",ExpressionUUID->"ce199056-16d0-4883-9a59-1a10e00b9365"]
}, Closed]],
Cell[CellGroupData[{
Cell[42821, 1037, 313, 5, 44, "Section",ExpressionUUID->"09ac9d3a-91ad-4125-a27c-3a7330fd7ac5"],
Cell[43137, 1044, 5909, 133, 925, "Input",ExpressionUUID->"a3aef63f-401d-4d25-bd95-0f92fa7027c5"]
}, Closed]],
Cell[CellGroupData[{
Cell[49083, 1182, 362, 6, 44, "Section",ExpressionUUID->"8d0d1af7-fcc4-4783-b65c-ab8f7ffa3ba2"],
Cell[49448, 1190, 5832, 131, 966, "Input",ExpressionUUID->"f9f02549-a8c6-4c72-8df4-62ffd924632d"]
}, Closed]],
Cell[CellGroupData[{
Cell[55317, 1326, 402, 6, 44, "Section",ExpressionUUID->"faaa3967-8064-48f1-a612-f6e18f0ab5fd"],
Cell[55722, 1334, 6296, 141, 987, "Input",ExpressionUUID->"6aaa50c1-4142-4010-b15b-b83f690f7630"]
}, Closed]],
Cell[CellGroupData[{
Cell[62055, 1480, 459, 7, 44, "Section",ExpressionUUID->"0d9d7614-7377-4a42-9694-ad0c2f2c8dca"],
Cell[62517, 1489, 6389, 143, 1007, "Input",ExpressionUUID->"7cea7cda-d6bd-4f2d-8d1b-f3b150b89850"]
}, Closed]],
Cell[CellGroupData[{
Cell[68943, 1637, 552, 8, 44, "Section",ExpressionUUID->"3b8081d0-b79b-46ff-8515-8fa9082a1ccc"],
Cell[69498, 1647, 7123, 156, 987, "Input",ExpressionUUID->"49201f12-b80d-4e32-ab1c-215e1ed1d799"]
}, Closed]],
Cell[CellGroupData[{
Cell[76658, 1808, 256, 4, 44, "Section",ExpressionUUID->"2bc60a79-e700-4b58-8d0e-8bbfa5a58481"],
Cell[76917, 1814, 5779, 142, 946, "Input",ExpressionUUID->"e023fe7d-f334-4fe5-8d1e-e98268ec1837"]
}, Closed]],
Cell[CellGroupData[{
Cell[82733, 1961, 500, 8, 44, "Section",ExpressionUUID->"a028fb09-f0fe-44b9-993e-777659d83339"],
Cell[83236, 1971, 10557, 247, 1357, "Input",ExpressionUUID->"0ab0b32a-e1d2-48f5-9334-6369003d64fe"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[93842, 2224, 169, 3, 35, "Title",ExpressionUUID->"11f83cd4-d82e-4d87-b5fd-c34399b0df27"],
Cell[CellGroupData[{
Cell[94036, 2231, 170, 3, 74, "Section",ExpressionUUID->"9dabb1ed-2e99-443f-932c-2a303feb5221"],
Cell[CellGroupData[{
Cell[94231, 2238, 151, 3, 35, "Subsection",ExpressionUUID->"865f6cbf-3ec2-4cd9-bded-dd49e6b42038"],
Cell[94385, 2243, 879, 26, 84, "Input",ExpressionUUID->"fa9c792d-b0a5-407a-a2f6-9aa80cc8dcaa"]
}, Closed]],
Cell[CellGroupData[{
Cell[95301, 2274, 162, 3, 27, "Subsection",ExpressionUUID->"bd1150c7-3784-45a6-8438-3f6faabac889"],
Cell[95466, 2279, 1288, 23, 124, "Input",ExpressionUUID->"147a9c50-f48d-41d1-8e2e-87ab4360e989"]
}, Closed]],
Cell[CellGroupData[{
Cell[96791, 2307, 160, 3, 27, "Subsection",ExpressionUUID->"bb4cabbe-4c1f-4868-844c-2d689adb8077"],
Cell[96954, 2312, 847, 18, 186, "Input",ExpressionUUID->"86b0f729-b49e-483f-bef0-77fdcf4b4757"]
}, Closed]],
Cell[CellGroupData[{
Cell[97838, 2335, 175, 3, 27, "Subsection",ExpressionUUID->"e4a8b6af-ce24-4ebe-b7df-aafffb17d9d7"],
Cell[98016, 2340, 1568, 37, 268, "Input",ExpressionUUID->"d1cd63be-21fe-429b-ba58-b15c8aa67195"]
}, Closed]],
Cell[CellGroupData[{
Cell[99621, 2382, 173, 3, 27, "Subsection",ExpressionUUID->"3742924f-35e8-45c1-acde-7bb9c9dd75ee"],
Cell[99797, 2387, 824, 18, 165, "Input",ExpressionUUID->"79dd37b4-d01d-472c-aaee-a1390b870869"]
}, Closed]],
Cell[CellGroupData[{
Cell[100658, 2410, 233, 4, 27, "Subsection",ExpressionUUID->"1874014e-d625-46c8-8692-f4b02cdcabf0"],
Cell[100894, 2416, 2275, 51, 391, "Input",ExpressionUUID->"feee99de-2ef4-48c8-93c0-9bff5ee40e8d"]
}, Closed]],
Cell[CellGroupData[{
Cell[103206, 2472, 227, 4, 27, "Subsection",ExpressionUUID->"a623d8c3-01b2-4419-8152-8db67cc6fc0e"],
Cell[103436, 2478, 837, 19, 165, "Input",ExpressionUUID->"c51275a6-88d2-4a1e-9d53-859341442687"]
}, Closed]],
Cell[CellGroupData[{
Cell[104310, 2502, 187, 3, 27, "Subsection",ExpressionUUID->"c5038e68-35e0-498d-9618-d339d1548100"],
Cell[104500, 2507, 2337, 43, 473, "Input",ExpressionUUID->"03ac1245-a01e-4084-811d-f7fe089ca560"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[106886, 2556, 155, 3, 44, "Section",ExpressionUUID->"eedbedb9-c140-497a-b81c-47324a01d5ac"],
Cell[CellGroupData[{
Cell[107066, 2563, 218, 4, 35, "Subsection",ExpressionUUID->"bea3b258-a19e-49c3-87a9-6a08518ef513"],
Cell[107287, 2569, 4777, 121, 317, "Input",ExpressionUUID->"435096a1-0604-4b9a-ac01-fa0009db88df"]
}, Closed]],
Cell[CellGroupData[{
Cell[112101, 2695, 163, 3, 27, "Subsection",ExpressionUUID->"36752436-f1d2-4593-8efd-8291ec0937ba"],
Cell[112267, 2700, 5158, 137, 206, "Input",ExpressionUUID->"e10e0cab-ff4d-4d74-b62a-a7dc31276209"]
}, Closed]],
Cell[CellGroupData[{
Cell[117462, 2842, 175, 3, 27, "Subsection",ExpressionUUID->"0f506c05-a7f6-4ffc-bd70-27da0789fab7"],
Cell[117640, 2847, 7458, 175, 186, "Input",ExpressionUUID->"5b7667f1-d45c-47c6-89f5-cb4cb6b3d952"]
}, Closed]],
Cell[CellGroupData[{
Cell[125135, 3027, 165, 3, 27, "Subsection",ExpressionUUID->"bd24b7a1-42e4-408d-9b78-71c1ef99e57b"],
Cell[125303, 3032, 7954, 157, 473, "Input",ExpressionUUID->"a190b50e-70d5-4a04-9c44-d1fb00f0166e"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[133306, 3195, 221, 4, 44, "Section",ExpressionUUID->"8876be30-6fdf-4ad0-b0b0-3b2f6e529aa8"],
Cell[CellGroupData[{
Cell[133552, 3203, 167, 3, 35, "Subsection",ExpressionUUID->"3cb637c0-587e-4093-bd7e-bf82d750d5bc"],
Cell[CellGroupData[{
Cell[133744, 3210, 167, 3, 25, "Subsubsection",ExpressionUUID->"44bce19c-130c-4a1f-b53f-23d590c0cc38"],
Cell[133914, 3215, 5180, 115, 864, "Input",ExpressionUUID->"e295a0f2-0705-4c30-96bd-245dcb56f107"]
}, Closed]],
Cell[CellGroupData[{
Cell[139131, 3335, 178, 3, 19, "Subsubsection",ExpressionUUID->"d442c503-ecb1-41aa-9824-c1d45f40f2d0"],
Cell[139312, 3340, 6644, 137, 884, "Input",ExpressionUUID->"44ac459e-3b5a-467f-a9bf-5c0b747a413e"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146005, 3483, 164, 3, 35, "Subsection",ExpressionUUID->"90e650f6-31f3-4509-8fa7-b5de9c6802c5"],
Cell[CellGroupData[{
Cell[146194, 3490, 157, 3, 25, "Subsubsection",ExpressionUUID->"d56604b1-f0d6-4310-a769-8c4fbe9a2305"],
Cell[CellGroupData[{
Cell[146376, 3497, 1183, 24, 165, "Input",ExpressionUUID->"040b0ede-cf47-4538-99f3-3de73d67efad"],
Cell[CellGroupData[{
Cell[147584, 3525, 494, 11, 23, "Print",ExpressionUUID->"b2c788ba-260f-4772-9d98-535846432aaa"],
Cell[148081, 3538, 494, 11, 23, "Print",ExpressionUUID->"979da7e3-ec78-49ce-be45-8ad668397272"],
Cell[148578, 3551, 496, 11, 23, "Print",ExpressionUUID->"0a2603b5-88cf-48c7-ac09-6fde31f2a34c"],
Cell[149077, 3564, 494, 11, 23, "Print",ExpressionUUID->"d1995b7e-615e-4c41-9ab5-723121e1e418"],
Cell[149574, 3577, 494, 11, 23, "Print",ExpressionUUID->"b367ae8c-b8b7-4fb4-bb27-0115e05ee055"],
Cell[150071, 3590, 494, 11, 23, "Print",ExpressionUUID->"de1dbfe2-0805-4d40-ac34-09e8c9ca0645"],
Cell[150568, 3603, 494, 11, 23, "Print",ExpressionUUID->"685a7065-1d06-46d1-b3f8-6c30393f2837"],
Cell[151065, 3616, 494, 11, 23, "Print",ExpressionUUID->"1dec362f-46e1-44dd-8ba6-e18dae341f25"],
Cell[151562, 3629, 496, 11, 23, "Print",ExpressionUUID->"c687190e-4c42-48a3-a414-fa39ba463708"],
Cell[152061, 3642, 494, 11, 23, "Print",ExpressionUUID->"340f0ff2-d05c-4c96-916a-00374b12949b"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[152616, 3660, 168, 3, 19, "Subsubsection",ExpressionUUID->"6f73d63c-6237-4356-a3ca-077d94cda7e7"],
Cell[CellGroupData[{
Cell[152809, 3667, 1903, 43, 186, "Input",ExpressionUUID->"380aa94f-bfae-4a19-9e42-a301c8acd007"],
Cell[CellGroupData[{
Cell[154737, 3714, 428, 10, 23, "Print",ExpressionUUID->"34dd6044-d633-457a-8088-715a2c9dd236"],
Cell[155168, 3726, 427, 10, 23, "Print",ExpressionUUID->"fa5cf5f3-fb2a-41ec-b28f-80abab000fe9"],
Cell[155598, 3738, 428, 10, 23, "Print",ExpressionUUID->"a5e3e308-e441-4342-9657-63542bc95fce"],
Cell[156029, 3750, 428, 10, 23, "Print",ExpressionUUID->"8d46bac0-f2e3-4d30-943e-3805b585d797"],
Cell[156460, 3762, 430, 10, 23, "Print",ExpressionUUID->"c581fe9f-267b-4c91-a3d9-cd08abcf8aec"],
Cell[156893, 3774, 428, 10, 23, "Print",ExpressionUUID->"677a5032-128b-4514-8473-4668c699df6d"],
Cell[157324, 3786, 427, 10, 23, "Print",ExpressionUUID->"0ed40e85-6fd4-4415-853c-ed0f22bb8c2d"],
Cell[157754, 3798, 430, 10, 23, "Print",ExpressionUUID->"9b3a4952-f639-49c7-a339-506e31ead6ec"],
Cell[158187, 3810, 427, 10, 23, "Print",ExpressionUUID->"eff82ac3-b047-4939-b698-bb1d820cee48"],
Cell[158617, 3822, 426, 10, 23, "Print",ExpressionUUID->"53de1373-1533-4d70-8c2e-44d80fa7af9f"],
Cell[159046, 3834, 428, 10, 23, "Print",ExpressionUUID->"9d6f777e-e9be-489f-a053-e3f9059670f6"],
Cell[159477, 3846, 430, 10, 23, "Print",ExpressionUUID->"cbbeeec3-a4a7-45ef-820e-c9d965966586"],
Cell[159910, 3858, 428, 10, 23, "Print",ExpressionUUID->"2299bcad-3c3e-4cfc-bc90-abfeaf12a258"],
Cell[160341, 3870, 428, 10, 23, "Print",ExpressionUUID->"c92afe87-edf0-4b1d-9610-75bca26ddec9"],
Cell[160772, 3882, 428, 10, 23, "Print",ExpressionUUID->"9d3c4407-2290-42f1-9038-b34da4a816b1"],
Cell[161203, 3894, 428, 10, 23, "Print",ExpressionUUID->"676ceee6-15dd-47f1-bae7-c0579461771a"],
Cell[161634, 3906, 428, 10, 23, "Print",ExpressionUUID->"992202d0-30a8-4a8f-b046-de8578e4c67f"],
Cell[162065, 3918, 428, 10, 23, "Print",ExpressionUUID->"3c4ff763-e8e3-4f4f-9d49-ecd1d0d96812"],
Cell[162496, 3930, 428, 10, 23, "Print",ExpressionUUID->"db94a1d4-2f89-4b5b-a1c9-e75d1e9e94ad"],
Cell[162927, 3942, 430, 10, 23, "Print",ExpressionUUID->"6998ea2d-9458-4900-a7e1-f6b4ca204bfd"],
Cell[163360, 3954, 428, 10, 23, "Print",ExpressionUUID->"81e402b5-913d-444a-a367-ccbc7f823d1d"],
Cell[163791, 3966, 430, 10, 23, "Print",ExpressionUUID->"df1ca7c5-da3f-43be-9f78-7b983eeae76c"],
Cell[164224, 3978, 427, 10, 23, "Print",ExpressionUUID->"221c766a-5765-4170-afe1-723ffc8441ba"],
Cell[164654, 3990, 428, 10, 23, "Print",ExpressionUUID->"865b965f-b503-4267-97a8-ac7e72cc27d8"],
Cell[165085, 4002, 428, 10, 23, "Print",ExpressionUUID->"5527e2b1-3f35-4e03-bae4-20f2d681ac4f"],
Cell[165516, 4014, 430, 10, 23, "Print",ExpressionUUID->"0f1fdc25-d7a4-4a0d-a7f6-0bbc50372b5e"],
Cell[165949, 4026, 428, 10, 23, "Print",ExpressionUUID->"afffdc7e-7a47-4610-ba3a-7b81b5ff8b60"],
Cell[166380, 4038, 428, 10, 23, "Print",ExpressionUUID->"dd485e97-0191-453c-9cb4-4a57524f2a89"],
Cell[166811, 4050, 428, 10, 23, "Print",ExpressionUUID->"a4153849-b285-4d7f-9c0f-bc3f14a1ed61"],
Cell[167242, 4062, 430, 10, 23, "Print",ExpressionUUID->"1d4e2a33-4651-4051-a1f9-d19fc720ca40"],
Cell[167675, 4074, 428, 10, 23, "Print",ExpressionUUID->"76d522bf-34a9-4a54-984e-ac4f9946ae04"],
Cell[168106, 4086, 428, 10, 23, "Print",ExpressionUUID->"33e0c512-10e9-47a1-a11f-c0f1de990805"],
Cell[168537, 4098, 428, 10, 23, "Print",ExpressionUUID->"2cb5a2d7-33f1-4e7f-b158-044b15169bcb"],
Cell[168968, 4110, 428, 10, 23, "Print",ExpressionUUID->"3346f661-595c-4c5d-9c17-2a0b9020e9e3"],
Cell[169399, 4122, 430, 10, 23, "Print",ExpressionUUID->"cd82ac74-8ef9-4207-ab1b-e1129ab6072f"],
Cell[169832, 4134, 428, 10, 23, "Print",ExpressionUUID->"34d29bf5-dea8-4859-9a84-837e1da563a5"],
Cell[170263, 4146, 428, 10, 23, "Print",ExpressionUUID->"bb95373e-dcd8-4ea1-8bd5-37ee7687ea33"],
Cell[170694, 4158, 428, 10, 23, "Print",ExpressionUUID->"ff867d59-4fcd-4d9e-9208-9df418851af2"],
Cell[171125, 4170, 428, 10, 23, "Print",ExpressionUUID->"ee492aa2-c4ab-49cc-863e-031aca291689"],
Cell[171556, 4182, 428, 10, 23, "Print",ExpressionUUID->"5e0c249c-2aa7-4af3-8efa-01c2f7593a69"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[172081, 4202, 171, 3, 35, "Title",ExpressionUUID->"2613027a-7433-408c-bdb2-bf5ea426ba00"],
Cell[CellGroupData[{
Cell[172277, 4209, 170, 3, 74, "Section",ExpressionUUID->"f668ea9c-6afc-4ea8-b7a0-bbcbd6b16a5f"],
Cell[CellGroupData[{
Cell[172472, 4216, 151, 3, 35, "Subsection",ExpressionUUID->"83a0fd7b-dfc0-4091-8b40-d06edf483805"],
Cell[172626, 4221, 879, 26, 84, "Input",ExpressionUUID->"488ff88f-f920-4a54-8584-de8ab1944521"]
}, Closed]],
Cell[CellGroupData[{
Cell[173542, 4252, 162, 3, 27, "Subsection",ExpressionUUID->"e17d89aa-44fa-472f-b154-9e1b16f8cec0"],
Cell[173707, 4257, 1288, 23, 124, "Input",ExpressionUUID->"701cff3b-b4c1-47a3-999f-c829079a9d51"]
}, Closed]],
Cell[CellGroupData[{
Cell[175032, 4285, 160, 3, 27, "Subsection",ExpressionUUID->"4758aa4e-6ced-4357-a571-83427046fdc0"],
Cell[175195, 4290, 693, 15, 124, "Input",ExpressionUUID->"41f7d5da-6dec-45b5-8b62-12b371cfd3ca"]
}, Closed]],
Cell[CellGroupData[{
Cell[175925, 4310, 175, 3, 27, "Subsection",ExpressionUUID->"d0d4954d-ac56-4f6a-9ab9-3ff4ffdbf4e1"],
Cell[176103, 4315, 1173, 26, 186, "Input",ExpressionUUID->"148f2b49-15b0-4f84-8948-7a346de5f488"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[177325, 4347, 215, 4, 44, "Section",ExpressionUUID->"c4e27016-b044-4cd1-8fe5-997e9d271404"],
Cell[177543, 4353, 4957, 124, 317, "Input",ExpressionUUID->"38ace2f9-1089-423a-8623-e2ca8ddadbf3"]
}, Closed]],
Cell[CellGroupData[{
Cell[182537, 4482, 166, 3, 44, "Section",ExpressionUUID->"100a3ab6-5c02-481c-8d87-4c76e42940f5"],
Cell[CellGroupData[{
Cell[182728, 4489, 7085, 163, 350, "Input",ExpressionUUID->"4ba86ddc-0e5f-44ae-98ec-40b6da900085"],
Cell[189816, 4654, 10033, 294, 184, "Output",ExpressionUUID->"aa44fdec-46b7-4c57-96ba-f01de2103b6d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[199898, 4954, 277, 4, 44, "Section",ExpressionUUID->"a94e94eb-0ea3-400a-8b3e-32ebab0fbf6a"],
Cell[CellGroupData[{
Cell[200200, 4962, 167, 3, 35, "Subsection",ExpressionUUID->"3de864e7-e5ff-45d1-88cf-5956f307e41d"],
Cell[200370, 4967, 5066, 106, 740, "Input",ExpressionUUID->"c50f8038-9720-426e-9a0b-bb7fd791994f"]
}, Closed]],
Cell[CellGroupData[{
Cell[205473, 5078, 164, 3, 27, "Subsection",ExpressionUUID->"391b9541-a0ac-4e2d-aea5-ff9baea81be9"],
Cell[205640, 5083, 811, 19, 104, "Input",ExpressionUUID->"7c2f0bad-e804-47e6-b71d-cccaa4e70058"],
Cell[206454, 5104, 1131, 31, 104, "Input",ExpressionUUID->"7353dd4f-5c21-473a-a35b-d53851de2c32"],
Cell[207588, 5137, 1181, 32, 104, "Input",ExpressionUUID->"775f1cf0-3922-495a-90b6-6e64474f088d"],
Cell[208772, 5171, 1180, 32, 104, "Input",ExpressionUUID->"e97241a2-0bcf-4a48-942c-7ff956e68c08"],
Cell[209955, 5205, 1182, 32, 104, "Input",ExpressionUUID->"7be3d94b-d3bc-4880-958e-068d6fc13679"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[211198, 5244, 212, 4, 35, "Title",ExpressionUUID->"05b4336b-849d-4472-ad96-bf9f8b1405ea"],
Cell[CellGroupData[{
Cell[211435, 5252, 170, 3, 74, "Section",ExpressionUUID->"288ea30b-31db-4167-afe9-3f84a5b1280f"],
Cell[CellGroupData[{
Cell[211630, 5259, 151, 3, 35, "Subsection",ExpressionUUID->"6fdb90ef-7289-4087-9288-b0a06593738d"],
Cell[211784, 5264, 879, 26, 84, "Input",ExpressionUUID->"b204f3c9-7645-4f47-acba-18ac09552ed7"]
}, Closed]],
Cell[CellGroupData[{
Cell[212700, 5295, 162, 3, 27, "Subsection",ExpressionUUID->"ed29b3ba-66b2-4edd-b146-6a20c4b2b9cd"],
Cell[212865, 5300, 1546, 28, 165, "Input",ExpressionUUID->"ed701c46-7d89-4cfb-ab0d-73ca4bd5b7be"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[214460, 5334, 252, 4, 44, "Section",ExpressionUUID->"6d505258-fcd1-46c2-8e81-9907bd72073d"],
Cell[214715, 5340, 2806, 59, 166, "Input",ExpressionUUID->"24bfb616-b6f9-45e2-a134-fa8bf0369bf8"]
}, Closed]],
Cell[CellGroupData[{
Cell[217558, 5404, 277, 4, 44, "Section",ExpressionUUID->"6f16d359-969c-41f9-a795-5dd3c0c2a36c"],
Cell[CellGroupData[{
Cell[217860, 5412, 167, 3, 35, "Subsection",ExpressionUUID->"1a638307-d4b5-403c-8ca0-e7147fa89e64"],
Cell[218030, 5417, 4908, 100, 761, "Input",ExpressionUUID->"0244c3a6-0759-4697-8848-50398ef8d1aa"]
}, Closed]],
Cell[CellGroupData[{
Cell[222975, 5522, 164, 3, 27, "Subsection",ExpressionUUID->"ea4f81cf-fd4d-4208-9015-cc3120bf542b"],
Cell[223142, 5527, 844, 20, 62, "Input",ExpressionUUID->"09a6876b-24ea-46af-b33c-af577e1c7856"],
Cell[223989, 5549, 833, 22, 62, "Input",ExpressionUUID->"885247e7-84a2-4d12-80f0-b0dec57eb4f7"],
Cell[224825, 5573, 950, 26, 62, "Input",ExpressionUUID->"5e220a8a-9254-4d70-98d7-3006387616de"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[225836, 5606, 262, 4, 35, "Title",ExpressionUUID->"2a0d039c-ffec-40dc-947a-a2c41707f5c1"],
Cell[CellGroupData[{
Cell[226123, 5614, 170, 3, 74, "Section",ExpressionUUID->"b2202387-2253-41db-a919-1ecd34bb2508"],
Cell[CellGroupData[{
Cell[226318, 5621, 151, 3, 35, "Subsection",ExpressionUUID->"a089c63b-8ea4-49db-8c18-b647a5c4928d"],
Cell[226472, 5626, 879, 26, 84, "Input",ExpressionUUID->"5f67d75b-53f7-417f-a435-ca173754c077"]
}, Closed]],
Cell[CellGroupData[{
Cell[227388, 5657, 162, 3, 27, "Subsection",ExpressionUUID->"3770cc53-072e-49b2-b44f-e6fc12501006"],
Cell[227553, 5662, 1546, 28, 165, "Input",ExpressionUUID->"265b581f-9a57-45e2-a844-8a2eb95adfe2"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[229148, 5696, 314, 5, 44, "Section",ExpressionUUID->"e90ec935-fe99-4cc8-b717-5585d02132aa"],
Cell[229465, 5703, 4707, 115, 477, "Input",ExpressionUUID->"577fd845-82e9-4819-ac9b-6f27da9396a3"]
}, Closed]],
Cell[CellGroupData[{
Cell[234209, 5823, 277, 4, 44, "Section",ExpressionUUID->"8143fbf6-b681-4775-bf68-f72dd9f143c0"],
Cell[CellGroupData[{
Cell[234511, 5831, 167, 3, 35, "Subsection",ExpressionUUID->"75b98004-29f4-457d-9ed7-a0d1a49870ea"],
Cell[234681, 5836, 5309, 106, 638, "Input",ExpressionUUID->"b567264b-b264-458d-bed9-c9452022ce2b"]
}, Closed]],
Cell[CellGroupData[{
Cell[240027, 5947, 164, 3, 27, "Subsection",ExpressionUUID->"bb9b8247-974a-4a43-81ee-23e68325295d"],
Cell[240194, 5952, 9597, 248, 843, "Input",ExpressionUUID->"f2e5c8d5-ad19-4410-9928-ad61f5faa523"]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

